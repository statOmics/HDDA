<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Milan Malfait" />


<title>Lab 5: Clustering</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">HDDA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="intro.html">1. Introduction</a>
    </li>
    <li>
      <a href="svd.html">2. Singular Value Decomposition</a>
    </li>
    <li>
      <a href="prediction.html">3. Prediction with High Dimensional Predictors</a>
    </li>
    <li>
      <a href="sparseSvd.html">4. Sparse Singular Value Decomposition</a>
    </li>
    <li>
      <a href="lda.html">5. Linear Discriminant Analysis</a>
    </li>
    <li>
      <a href="hclust.html">6.1. Introduction to Clustering</a>
    </li>
    <li>
      <a href="https://sites.stat.washington.edu/people/raftery/Research/PDF/fraley1998.pdf">6.2. Paper Model-based Clustering</a>
    </li>
    <li>
      <a href="em.html">6.3. EM algorithm</a>
    </li>
    <li>
      <a href="lsi.html">7. Large Scale Inference</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lab1-Intro-SVD.html">Lab 1: Intro &amp; SVD</a>
    </li>
    <li>
      <a href="Lab2-PCA.html">Lab 2: SVD - PCA</a>
    </li>
    <li>
      <a href="Lab3-Penalized-Regression.html">Lab 3: Prediction</a>
    </li>
    <li>
      <a href="Lab4-Sparse-PCA-LDA.html">Lab 4: Sparse PCA &amp; LDA</a>
    </li>
    <li>
      <a href="Lab5-Clustering.html">Lab 5: Clustering</a>
    </li>
    <li>
      <a href="Lab6-Large-Scale-Inference.html">Lab 6: LSI</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="https://github.com/statOmics/HDDA">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Lab 5: Clustering</h1>
<h3 class="subtitle">High Dimensional Data Analysis practicals</h3>
<h4 class="author">Milan Malfait</h4>
<h4 class="date">24 Feb 2022 <br/> (Last updated: 2022-02-22)</h4>

</div>


<div id="change-log" class="section level3 unnumbered">
<h3><a href="https://github.com/statOmics/HDDA/commits/master/Lab6-Clustering.Rmd">Change log</a></h3>
<hr />
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## Install necessary packages with:</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># install.packages(c(&quot;mclust&quot;, &quot;gclus&quot;, &quot;GGally&quot;, &quot;tidyverse&quot;))</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># if (!requireNamespace(&quot;remotes&quot;, quietly = TRUE)) {</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#     install.packages(&quot;remotes&quot;)</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;vqv/ggbiplot&quot;)</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">library</span>(mclust)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="fu">library</span>(gclus)  <span class="co"># contains the &#39;wine&#39; data</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="fu">library</span>(ggbiplot)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span></code></pre></div>
</div>
<div id="the-wine-data" class="section level1" number="1">
<h1><span class="header-section-number">1</span> The wine data</h1>
<p>In this lab session, we will explore the <a href="https://rdrr.io/cran/gclus/man/wine.html"><code>wine</code></a> data, following the
example analysis from <a href="https://svn.r-project.org/Rjournal/html/archive/2016/RJ-2016-021/RJ-2016-021.pdf">Scrucca <em>et al.</em> (2016)</a>.</p>
<p>This dataset provides 13 measurements obtained from a chemical analysis of 178
wines grown in the same region in Italy but derived from three different
cultivars (Barolo, Grignolino, Barbera). The original cultivar labels are
provided in the dataset.</p>
<p>We will apply different clustering algorithms and validate them by comparing how
well the clusters capture the original classes.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;wine&quot;</span>, <span class="at">package =</span> <span class="st">&quot;gclus&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>class <span class="ot">&lt;-</span> <span class="fu">factor</span>(wine<span class="sc">$</span>Class, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Barolo&quot;</span>, <span class="st">&quot;Grignolino&quot;</span>, <span class="st">&quot;Barbera&quot;</span>))</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">table</span>(class)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; class</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;     Barolo Grignolino    Barbera </span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt;         59         71         48</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(wine[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="fu">summary</span>(X)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt;     Alcohol          Malic            Ash          Alcalinity   </span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt;  Min.   :11.03   Min.   :0.740   Min.   :1.360   Min.   :10.60  </span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:12.36   1st Qu.:1.603   1st Qu.:2.210   1st Qu.:17.20  </span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt;  Median :13.05   Median :1.865   Median :2.360   Median :19.50  </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt;  Mean   :13.00   Mean   :2.336   Mean   :2.367   Mean   :19.49  </span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:13.68   3rd Qu.:3.083   3rd Qu.:2.558   3rd Qu.:21.50  </span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt;  Max.   :14.83   Max.   :5.800   Max.   :3.230   Max.   :30.00  </span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt;    Magnesium         Phenols        Flavanoids     Nonflavanoid   </span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt;  Min.   : 70.00   Min.   :0.980   Min.   :0.340   Min.   :0.1300  </span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: 88.00   1st Qu.:1.742   1st Qu.:1.205   1st Qu.:0.2700  </span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt;  Median : 98.00   Median :2.355   Median :2.135   Median :0.3400  </span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt;  Mean   : 99.74   Mean   :2.295   Mean   :2.029   Mean   :0.3619  </span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:107.00   3rd Qu.:2.800   3rd Qu.:2.875   3rd Qu.:0.4375  </span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt;  Max.   :162.00   Max.   :3.880   Max.   :5.080   Max.   :0.6600  </span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt;  Proanthocyanins   Intensity           Hue             OD280      </span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt;  Min.   :0.410   Min.   : 1.280   Min.   :0.4800   Min.   :1.270  </span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:1.250   1st Qu.: 3.220   1st Qu.:0.7825   1st Qu.:1.938  </span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt;  Median :1.555   Median : 4.690   Median :0.9650   Median :2.780  </span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt;  Mean   :1.591   Mean   : 5.058   Mean   :0.9575   Mean   :2.612  </span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:1.950   3rd Qu.: 6.200   3rd Qu.:1.1200   3rd Qu.:3.170  </span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt;  Max.   :3.580   Max.   :13.000   Max.   :1.7100   Max.   :4.000  </span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">#&gt;     Proline      </span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co">#&gt;  Min.   : 278.0  </span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: 500.5  </span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="co">#&gt;  Median : 673.5  </span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="co">#&gt;  Mean   : 746.9  </span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 985.0  </span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="co">#&gt;  Max.   :1680.0</span></span></code></pre></div>
</div>
<div id="hierarchical-clustering" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Hierarchical clustering</h1>
<div id="tasks" class="section level3 unnumbered">
<h3>Tasks</h3>
<div id="perform-hierarhical-clustering-of-the-wine-data-using-a-euclidean-distance-matrix-and-the-complete-linkage-algorithm-see-hclust.-plot-the-clustering-dendrogram." class="section level4 unnumbered">
<h4>1. Perform hierarhical clustering of the wine data, using a Euclidean distance matrix and the complete-linkage algorithm (see <code>?hclust</code>). Plot the clustering <em>dendrogram</em>.</h4>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="do">## Calculate distance matrix and perform hierarchical clustering</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>wine_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(X, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(wine_dist, <span class="at">method =</span> <span class="st">&quot;complete&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">plot</span>(hc, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</details>
</div>
<div id="select-an-appropriate-number-of-clusters-from-the-hierarchical-clustering-see-cutree.-visualize-the-clusters-on-a-pca-biplot-and-compare-with-the-original-labels." class="section level4 unnumbered">
<h4>2. Select an appropriate number of clusters from the hierarchical clustering (see <code>?cutree</code>). Visualize the clusters on a PCA biplot and compare with the original labels.</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>hc_clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">table</span>(class, hc_clusters)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;             hc_clusters</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; class         1  2  3</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt;   Barolo     43 16  0</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt;   Grignolino  0 15 56</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt;   Barbera     0 21 27</span></span></code></pre></div>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>wine_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(X, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">ggbiplot</span>(wine_pca, <span class="at">groups =</span> class) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Original labels&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.8</span>, <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">ggbiplot</span>(wine_pca, <span class="at">groups =</span> <span class="fu">factor</span>(hc_clusters)) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;HC clusters&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.8</span>, <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-4-1.png" width="672" /><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
</details>
</div>
<div id="bonus-can-you-improve-the-results-by-using-different-distance-metrics-or-linkages" class="section level4 unnumbered">
<h4>Bonus: can you improve the results by using different distance metrics or linkages?</h4>
</div>
</div>
</div>
<div id="model-based-clustering" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Model-based clustering</h1>
<div id="tasks-1" class="section level3 unnumbered">
<h3>Tasks</h3>
<div id="perform-model-based-clustering-on-the-wine-data-use-mclustmclustmclust.-plot-the-bic-values-and-interpret-the-results.-compare-the-identified-clusters-with-the-original-true-labels." class="section level4 unnumbered">
<h4>1. Perform model-based clustering on the <code>wine</code> data (use <a href="https://rdrr.io/cran/mclust/man/Mclust.html"><code>mclust::Mclust()</code></a>). Plot the BIC values and interpret the results. Compare the identified clusters with the original (true) labels.</h4>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(X)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">summary</span>(mod)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------- </span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; Gaussian finite mixture model fitted by EM algorithm </span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------- </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; Mclust VVE (ellipsoidal, equal orientation) model with 3 components: </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt;  log-likelihood   n  df       BIC       ICL</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;       -3015.335 178 158 -6849.391 -6850.734</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; Clustering table:</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt;  1  2  3 </span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; 59 69 50</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="fu">summary</span>(mod<span class="sc">$</span>BIC)</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; Best BIC values:</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt;              VVE,3       EVE,4       VVE,4</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; BIC      -6849.391 -6873.61648 -6885.47222</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; BIC diff     0.000   -24.22499   -36.08073</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">table</span>(class, mod<span class="sc">$</span>classification)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt;             </span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; class         1  2  3</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt;   Barolo     59  0  0</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt;   Grignolino  0 69  2</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt;   Barbera     0  0 48</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="do">## Annotate clusters</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>mc_clusters <span class="ot">&lt;-</span> <span class="fu">factor</span>(mod<span class="sc">$</span>classification)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="at">what =</span> <span class="st">&quot;BIC&quot;</span>, <span class="at">ylim =</span> <span class="fu">range</span>(mod<span class="sc">$</span>BIC[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="at">legendArgs =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">&quot;bottomleft&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="at">what =</span> <span class="st">&quot;classification&quot;</span>)</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-7-1.png" width="672" /><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<p>There is a clear indication of a three-component mixture with covariances having
different shapes and volumes but the same orientation (VVE). See
<code>?mclustModelNames</code> for a description of the different <code>mclust</code> models.</p>
</details>
</div>
<div id="visualize-the-clusters-found-by-mclust-on-the-pca-biplot.-compare-with-the-original-labels." class="section level4 unnumbered">
<h4>2. Visualize the clusters found by <code>Mclust()</code> on the PCA biplot. Compare with the original labels.</h4>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">ggbiplot</span>(wine_pca, <span class="at">groups =</span> class) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Original labels&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.8</span>, <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="do">## PCA plot annotated with clusters</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="fu">ggbiplot</span>(wine_pca, <span class="at">groups =</span> mc_clusters) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;mclust clusters&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.8</span>, <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-8-1.png" width="672" /><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
</details>
</div>
<div id="perform-a-dimensionality-reduction-of-the-wine-data-using-the-pca.-select-an-appropriate-number-of-pcs.-redo-the-clustering-on-this-reduced-dimension-representation-and-make-the-same-figures-as-before.-how-do-the-results-differ" class="section level4 unnumbered">
<h4>3. Perform a dimensionality reduction of the wine data using the PCA. Select an appropriate number of PC’s. Redo the clustering on this reduced dimension representation and make the same figures as before. How do the results differ?</h4>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="do">## Calculate total variance by summing the PC variances (sdev&#39;s squared)</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>tot_var <span class="ot">&lt;-</span> <span class="fu">sum</span>(wine_pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="do">## Create data.frame of the proportion of variance explained by each PC</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>wine_prop_var <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="at">PC =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(wine_pca<span class="sc">$</span>x),</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="at">var =</span> wine_pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="do">## Using `mutate` to calculate prop. var and cum. prop. var</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>    <span class="at">prop_var =</span> var <span class="sc">/</span> tot_var,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>    <span class="at">cum_prop_var =</span> <span class="fu">cumsum</span>(var <span class="sc">/</span> tot_var)</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>  )</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>wine_prop_var</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["PC"],"name":[1],"type":["int"],"align":["right"]},{"label":["var"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["prop_var"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cum_prop_var"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"4.7057761","3":"0.361982781","4":"0.3619828"},{"1":"2","2":"2.4970309","3":"0.192079302","4":"0.5540621"},{"1":"3","2":"1.4460619","3":"0.111235528","4":"0.6652976"},{"1":"4","2":"0.9190803","3":"0.070698485","4":"0.7359961"},{"1":"5","2":"0.8531963","3":"0.065630484","4":"0.8016266"},{"1":"6","2":"0.6416517","3":"0.049357825","4":"0.8509844"},{"1":"7","2":"0.5510366","3":"0.042387429","4":"0.8933718"},{"1":"8","2":"0.3485625","3":"0.026812501","4":"0.9201843"},{"1":"9","2":"0.2888617","3":"0.022220130","4":"0.9424045"},{"1":"10","2":"0.2508366","3":"0.019295127","4":"0.9616996"},{"1":"11","2":"0.2257865","3":"0.017368191","4":"0.9790678"},{"1":"12","2":"0.1687476","3":"0.012980583","4":"0.9920484"},{"1":"13","2":"0.1033712","3":"0.007951634","4":"1.0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="do">## Plot the proportion of variance explained by each PC</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(wine_prop_var, <span class="fu">aes</span>(PC, prop_var)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">6.5</span>, <span class="at">col =</span> <span class="st">&quot;firebrick&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(wine_pca<span class="sc">$</span>x)) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Proportion of variance&quot;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="do">## Plot the cumulative proportion of variance explained by each PC</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(wine_prop_var, <span class="fu">aes</span>(PC, cum_prop_var)) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">6.5</span>, <span class="at">col =</span> <span class="st">&quot;firebrick&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(wine_pca<span class="sc">$</span>x)) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Cumulative proportion of variance&quot;</span>)</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Selecting first 6 PC’s, keeping 85% of the variance.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>pca_X <span class="ot">&lt;-</span> wine_pca<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span>k]</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">head</span>(pca_X)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt;         PC1        PC2        PC3        PC4        PC5        PC6</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; 1 -3.307408 -1.4394177 -0.1652440 -0.2152179 -0.6910307 -0.2231956</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; 2 -2.203240  0.3324370 -2.0207491 -0.2902412  0.2569609 -0.9245244</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; 3 -2.509638 -1.0282909  0.9800836  0.7227336  0.2502287  0.5476659</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; 4 -3.746485 -2.7487002 -0.1756584  0.5665219  0.3109223  0.1140307</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; 5 -1.006024 -0.8674094  2.0209708 -0.4087227 -0.2975062 -0.4053395</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; 6 -3.041653 -2.1164278 -0.6276464 -0.5140695  0.6304008  0.1230408</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(pca_X)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------- </span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; Gaussian finite mixture model fitted by EM algorithm </span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------- </span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt; Mclust VII (spherical, varying volume) model with 4 components: </span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt;  log-likelihood   n df       BIC       ICL</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt;       -1567.031 178 31 -3294.696 -3324.244</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; Clustering table:</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt;  1  2  3  4 </span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt; 54 51 46 27</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="fu">summary</span>(mod2<span class="sc">$</span>BIC)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt; Best BIC values:</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt;              VII,4        VEI,4        VVE,4</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; BIC      -3294.696 -3298.353891 -3301.319438</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#&gt; BIC diff     0.000    -3.657574    -6.623122</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">table</span>(class, mod2<span class="sc">$</span>classification)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt;             </span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; class         1  2  3  4</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt;   Barolo     54  0  0  5</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt;   Grignolino  0 51  1 19</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt;   Barbera     0  0 45  3</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="do">## Annotate clusters</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>mc_pca_clusters <span class="ot">&lt;-</span> <span class="fu">factor</span>(mod2<span class="sc">$</span>classification)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">what =</span> <span class="st">&quot;BIC&quot;</span>, <span class="at">ylim =</span> <span class="fu">range</span>(mod2<span class="sc">$</span>BIC[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="at">legendArgs =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">&quot;bottomleft&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca_X)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>df<span class="sc">$</span>clusters <span class="ot">&lt;-</span> mc_pca_clusters</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="do">## Using ggscatmat() from GGally package to plot all pairwise PCs</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="fu">ggscatmat</span>(df, <span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span>k, <span class="at">color =</span> <span class="st">&quot;clusters&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">aspect.ratio =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>, <span class="at">name =</span> <span class="st">&quot;mclust-PCA clusters&quot;</span>)</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p><em>Note: you can ignore the upper-right panels of this figure. These give the correlations between each pair of variables (PC’s here) for each group, but are not relevant here.</em></p>
</details>
</div>
</div>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1>Session info</h1>
<details>
<summary>
Session info
</summary>
<pre><code>#&gt; [1] &quot;2024-10-07 12:42:37 CEST&quot;
#&gt; ─ Session info ───────────────────────────────────────────────────────────────
#&gt;  setting  value
#&gt;  version  R version 4.4.0 RC (2024-04-16 r86468)
#&gt;  os       macOS Big Sur 11.6
#&gt;  system   aarch64, darwin20
#&gt;  ui       X11
#&gt;  language (EN)
#&gt;  collate  en_US.UTF-8
#&gt;  ctype    en_US.UTF-8
#&gt;  tz       Europe/Brussels
#&gt;  date     2024-10-07
#&gt;  pandoc   3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown)
#&gt; 
#&gt; ─ Packages ───────────────────────────────────────────────────────────────────
#&gt;  package      * version date (UTC) lib source
#&gt;  bookdown       0.40    2024-07-02 [1] CRAN (R 4.4.0)
#&gt;  bslib          0.8.0   2024-07-29 [1] CRAN (R 4.4.0)
#&gt;  cachem         1.1.0   2024-05-16 [1] CRAN (R 4.4.0)
#&gt;  cli            3.6.3   2024-06-21 [1] CRAN (R 4.4.0)
#&gt;  cluster      * 2.1.6   2023-12-01 [1] CRAN (R 4.4.0)
#&gt;  colorspace     2.1-1   2024-07-26 [1] CRAN (R 4.4.0)
#&gt;  digest         0.6.37  2024-08-19 [1] CRAN (R 4.4.1)
#&gt;  dplyr        * 1.1.4   2023-11-17 [1] CRAN (R 4.4.0)
#&gt;  evaluate       1.0.0   2024-09-17 [1] CRAN (R 4.4.1)
#&gt;  fansi          1.0.6   2023-12-08 [1] CRAN (R 4.4.0)
#&gt;  farver         2.1.2   2024-05-13 [1] CRAN (R 4.4.0)
#&gt;  fastmap        1.2.0   2024-05-15 [1] CRAN (R 4.4.0)
#&gt;  forcats      * 1.0.0   2023-01-29 [1] CRAN (R 4.4.0)
#&gt;  gclus        * 1.3.2   2019-01-07 [1] CRAN (R 4.4.0)
#&gt;  generics       0.1.3   2022-07-05 [1] CRAN (R 4.4.0)
#&gt;  GGally       * 2.2.1   2024-02-14 [1] CRAN (R 4.4.0)
#&gt;  ggbiplot     * 0.55    2024-10-02 [1] Github (vqv/ggbiplot@f7ea76d)
#&gt;  ggplot2      * 3.5.1   2024-04-23 [1] CRAN (R 4.4.0)
#&gt;  ggstats        0.7.0   2024-09-22 [1] CRAN (R 4.4.1)
#&gt;  glue           1.8.0   2024-09-30 [1] CRAN (R 4.4.1)
#&gt;  gridExtra      2.3     2017-09-09 [1] CRAN (R 4.4.0)
#&gt;  gtable         0.3.5   2024-04-22 [1] CRAN (R 4.4.0)
#&gt;  highr          0.11    2024-05-26 [1] CRAN (R 4.4.0)
#&gt;  hms            1.1.3   2023-03-21 [1] CRAN (R 4.4.0)
#&gt;  htmltools      0.5.8.1 2024-04-04 [1] CRAN (R 4.4.0)
#&gt;  jquerylib      0.1.4   2021-04-26 [1] CRAN (R 4.4.0)
#&gt;  jsonlite       1.8.9   2024-09-20 [1] CRAN (R 4.4.1)
#&gt;  knitr          1.48    2024-07-07 [1] CRAN (R 4.4.0)
#&gt;  labeling       0.4.3   2023-08-29 [1] CRAN (R 4.4.0)
#&gt;  lifecycle      1.0.4   2023-11-07 [1] CRAN (R 4.4.0)
#&gt;  lubridate    * 1.9.3   2023-09-27 [1] CRAN (R 4.4.0)
#&gt;  magrittr       2.0.3   2022-03-30 [1] CRAN (R 4.4.0)
#&gt;  mclust       * 6.1.1   2024-04-29 [1] CRAN (R 4.4.0)
#&gt;  munsell        0.5.1   2024-04-01 [1] CRAN (R 4.4.0)
#&gt;  pillar         1.9.0   2023-03-22 [1] CRAN (R 4.4.0)
#&gt;  pkgconfig      2.0.3   2019-09-22 [1] CRAN (R 4.4.0)
#&gt;  plyr         * 1.8.9   2023-10-02 [1] CRAN (R 4.4.0)
#&gt;  purrr        * 1.0.2   2023-08-10 [1] CRAN (R 4.4.0)
#&gt;  R6             2.5.1   2021-08-19 [1] CRAN (R 4.4.0)
#&gt;  RColorBrewer   1.1-3   2022-04-03 [1] CRAN (R 4.4.0)
#&gt;  Rcpp           1.0.13  2024-07-17 [1] CRAN (R 4.4.0)
#&gt;  readr        * 2.1.5   2024-01-10 [1] CRAN (R 4.4.0)
#&gt;  rlang          1.1.4   2024-06-04 [1] CRAN (R 4.4.0)
#&gt;  rmarkdown      2.28    2024-08-17 [1] CRAN (R 4.4.0)
#&gt;  rstudioapi     0.16.0  2024-03-24 [1] CRAN (R 4.4.0)
#&gt;  sass           0.4.9   2024-03-15 [1] CRAN (R 4.4.0)
#&gt;  scales       * 1.3.0   2023-11-28 [1] CRAN (R 4.4.0)
#&gt;  sessioninfo    1.2.2   2021-12-06 [1] CRAN (R 4.4.0)
#&gt;  stringi        1.8.4   2024-05-06 [1] CRAN (R 4.4.0)
#&gt;  stringr      * 1.5.1   2023-11-14 [1] CRAN (R 4.4.0)
#&gt;  tibble       * 3.2.1   2023-03-20 [1] CRAN (R 4.4.0)
#&gt;  tidyr        * 1.3.1   2024-01-24 [1] CRAN (R 4.4.0)
#&gt;  tidyselect     1.2.1   2024-03-11 [1] CRAN (R 4.4.0)
#&gt;  tidyverse    * 2.0.0   2023-02-22 [1] CRAN (R 4.4.0)
#&gt;  timechange     0.3.0   2024-01-18 [1] CRAN (R 4.4.0)
#&gt;  tzdb           0.4.0   2023-05-12 [1] CRAN (R 4.4.0)
#&gt;  utf8           1.2.4   2023-10-22 [1] CRAN (R 4.4.0)
#&gt;  vctrs          0.6.5   2023-12-01 [1] CRAN (R 4.4.0)
#&gt;  withr          3.0.1   2024-07-31 [1] CRAN (R 4.4.0)
#&gt;  xfun           0.47    2024-08-17 [1] CRAN (R 4.4.0)
#&gt;  yaml           2.3.10  2024-07-26 [1] CRAN (R 4.4.0)
#&gt; 
#&gt;  [1] /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library
#&gt; 
#&gt; ──────────────────────────────────────────────────────────────────────────────</code></pre>
</details>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiTGFiIDU6IENsdXN0ZXJpbmciCnN1YnRpdGxlOiAiSGlnaCBEaW1lbnNpb25hbCBEYXRhIEFuYWx5c2lzIHByYWN0aWNhbHMiCmF1dGhvcjogIk1pbGFuIE1hbGZhaXQiCmRhdGU6ICIyNCBGZWIgMjAyMiA8YnIvPiAoTGFzdCB1cGRhdGVkOiAyMDIyLTAyLTIyKSIKLS0tCgpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRSwgY2FjaGU9RkFMU0V9CmtuaXRyOjpvcHRzX2NodW5rJHNldCgKICBjb2xsYXBzZSA9IFRSVUUsCiAgY29tbWVudCA9ICIjPiIsCiAgZmlnLnNob3cgPSAiaG9sZCIKKQoKb3B0aW9ucyh3aWR0aCA9IDgwKQpgYGAKCiMjIyBbQ2hhbmdlIGxvZ10oaHR0cHM6Ly9naXRodWIuY29tL3N0YXRPbWljcy9IRERBL2NvbW1pdHMvbWFzdGVyL0xhYjYtQ2x1c3RlcmluZy5SbWQpIHstfQoKKioqCgpgYGB7ciBsaWJyYXJpZXMsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CiMjIEluc3RhbGwgbmVjZXNzYXJ5IHBhY2thZ2VzIHdpdGg6CgojIGluc3RhbGwucGFja2FnZXMoYygibWNsdXN0IiwgImdjbHVzIiwgIkdHYWxseSIsICJ0aWR5dmVyc2UiKSkKCiMgaWYgKCFyZXF1aXJlTmFtZXNwYWNlKCJyZW1vdGVzIiwgcXVpZXRseSA9IFRSVUUpKSB7CiMgICAgIGluc3RhbGwucGFja2FnZXMoInJlbW90ZXMiKQojIH0KIyByZW1vdGVzOjppbnN0YWxsX2dpdGh1YigidnF2L2dnYmlwbG90IikKCmxpYnJhcnkobWNsdXN0KQpsaWJyYXJ5KGdjbHVzKSAgIyBjb250YWlucyB0aGUgJ3dpbmUnIGRhdGEKbGlicmFyeShnZ2JpcGxvdCkKbGlicmFyeShHR2FsbHkpCmxpYnJhcnkodGlkeXZlcnNlKQoKdGhlbWVfc2V0KHRoZW1lX21pbmltYWwoKSkKYGBgCgoKIyBUaGUgd2luZSBkYXRhCgpJbiB0aGlzIGxhYiBzZXNzaW9uLCB3ZSB3aWxsIGV4cGxvcmUgdGhlIFtgd2luZWBdW3dpbmVdIGRhdGEsIGZvbGxvd2luZyB0aGUKZXhhbXBsZSBhbmFseXNpcyBmcm9tIFtTY3J1Y2NhICpldCBhbC4qICgyMDE2KV1bc2NydWNjYTIwMTZdLgoKVGhpcyBkYXRhc2V0IHByb3ZpZGVzIDEzIG1lYXN1cmVtZW50cyBvYnRhaW5lZCBmcm9tIGEgY2hlbWljYWwgYW5hbHlzaXMgb2YgMTc4CndpbmVzIGdyb3duIGluIHRoZSBzYW1lIHJlZ2lvbiBpbiBJdGFseSBidXQgZGVyaXZlZCBmcm9tIHRocmVlIGRpZmZlcmVudApjdWx0aXZhcnMgKEJhcm9sbywgR3JpZ25vbGlubywgQmFyYmVyYSkuIFRoZSBvcmlnaW5hbCBjdWx0aXZhciBsYWJlbHMgYXJlCnByb3ZpZGVkIGluIHRoZSBkYXRhc2V0LgoKV2Ugd2lsbCBhcHBseSBkaWZmZXJlbnQgY2x1c3RlcmluZyBhbGdvcml0aG1zIGFuZCB2YWxpZGF0ZSB0aGVtIGJ5IGNvbXBhcmluZyBob3cKd2VsbCB0aGUgY2x1c3RlcnMgY2FwdHVyZSB0aGUgb3JpZ2luYWwgY2xhc3Nlcy4KCmBgYHtyfQpkYXRhKCJ3aW5lIiwgcGFja2FnZSA9ICJnY2x1cyIpCmNsYXNzIDwtIGZhY3Rvcih3aW5lJENsYXNzLCBsZXZlbHMgPSAxOjMsIGxhYmVscyA9IGMoIkJhcm9sbyIsICJHcmlnbm9saW5vIiwgIkJhcmJlcmEiKSkKdGFibGUoY2xhc3MpCgpYIDwtIGFzLm1hdHJpeCh3aW5lWywgLTFdKQpzdW1tYXJ5KFgpCmBgYAoKCiMgSGllcmFyY2hpY2FsIGNsdXN0ZXJpbmcKCiMjIyBUYXNrcyB7LX0KCiMjIyMgMS4gUGVyZm9ybSBoaWVyYXJoaWNhbCBjbHVzdGVyaW5nIG9mIHRoZSB3aW5lIGRhdGEsIHVzaW5nIGEgRXVjbGlkZWFuIGRpc3RhbmNlIG1hdHJpeCBhbmQgdGhlIGNvbXBsZXRlLWxpbmthZ2UgYWxnb3JpdGhtIChzZWUgYD9oY2x1c3RgKS4gUGxvdCB0aGUgY2x1c3RlcmluZyAqZGVuZHJvZ3JhbSouIHstfQoKPGRldGFpbHM+PHN1bW1hcnk+U29sdXRpb248L3N1bW1hcnk+CgpgYGB7cn0KIyMgQ2FsY3VsYXRlIGRpc3RhbmNlIG1hdHJpeCBhbmQgcGVyZm9ybSBoaWVyYXJjaGljYWwgY2x1c3RlcmluZwp3aW5lX2Rpc3QgPC0gZGlzdChYLCBtZXRob2QgPSAiZXVjbGlkZWFuIikKaGMgPC0gaGNsdXN0KHdpbmVfZGlzdCwgbWV0aG9kID0gImNvbXBsZXRlIikKCnBsb3QoaGMsIGxhYmVscyA9IEZBTFNFKQpgYGAKCjwvZGV0YWlscz4KCiMjIyMgMi4gU2VsZWN0IGFuIGFwcHJvcHJpYXRlIG51bWJlciBvZiBjbHVzdGVycyBmcm9tIHRoZSBoaWVyYXJjaGljYWwgY2x1c3RlcmluZyAoc2VlIGA/Y3V0cmVlYCkuIFZpc3VhbGl6ZSB0aGUgY2x1c3RlcnMgb24gYSBQQ0EgYmlwbG90IGFuZCBjb21wYXJlIHdpdGggdGhlIG9yaWdpbmFsIGxhYmVscy4gey19CgpgYGB7cn0KaGNfY2x1c3RlcnMgPC0gY3V0cmVlKGhjLCBrID0gMykKdGFibGUoY2xhc3MsIGhjX2NsdXN0ZXJzKQpgYGAKCjxkZXRhaWxzPjxzdW1tYXJ5PlNvbHV0aW9uPC9zdW1tYXJ5PgoKYGBge3IsIGZpZy5hc3A9MX0Kd2luZV9wY2EgPC0gcHJjb21wKFgsIHNjYWxlLiA9IFRSVUUpCgpnZ2JpcGxvdCh3aW5lX3BjYSwgZ3JvdXBzID0gY2xhc3MpICsKICBzY2FsZV9jb2xvcl9icmV3ZXIocGFsZXR0ZSA9ICJTZXQyIikgKwogIGxhYnMoY29sb3IgPSAiT3JpZ2luYWwgbGFiZWxzIikgKwogIHRoZW1lKGFzcGVjdC5yYXRpbyA9IDAuOCwgbGVnZW5kLnBvc2l0aW9uID0gInRvcCIpCgpnZ2JpcGxvdCh3aW5lX3BjYSwgZ3JvdXBzID0gZmFjdG9yKGhjX2NsdXN0ZXJzKSkgKwogIHNjYWxlX2NvbG9yX2JyZXdlcihwYWxldHRlID0gIlNldDIiKSArCiAgbGFicyhjb2xvciA9ICJIQyBjbHVzdGVycyIpICsKICB0aGVtZShhc3BlY3QucmF0aW8gPSAwLjgsIGxlZ2VuZC5wb3NpdGlvbiA9ICJ0b3AiKQpgYGAKCjwvZGV0YWlscz4KCiMjIyMgQm9udXM6IGNhbiB5b3UgaW1wcm92ZSB0aGUgcmVzdWx0cyBieSB1c2luZyBkaWZmZXJlbnQgZGlzdGFuY2UgbWV0cmljcyBvciBsaW5rYWdlcz8gey19CgoKIyBNb2RlbC1iYXNlZCBjbHVzdGVyaW5nCgojIyMgVGFza3Mgey19CgojIyMjIDEuIFBlcmZvcm0gbW9kZWwtYmFzZWQgY2x1c3RlcmluZyBvbiB0aGUgYHdpbmVgIGRhdGEgKHVzZSBbYG1jbHVzdDo6TWNsdXN0KClgXVttY2x1c3RdKS4gUGxvdCB0aGUgQklDIHZhbHVlcyBhbmQgaW50ZXJwcmV0IHRoZSByZXN1bHRzLiBDb21wYXJlIHRoZSBpZGVudGlmaWVkIGNsdXN0ZXJzIHdpdGggdGhlIG9yaWdpbmFsICh0cnVlKSBsYWJlbHMuIHstfQoKPGRldGFpbHM+PHN1bW1hcnk+U29sdXRpb248L3N1bW1hcnk+CgpgYGB7cn0KbW9kIDwtIE1jbHVzdChYKQpzdW1tYXJ5KG1vZCkKc3VtbWFyeShtb2QkQklDKQpgYGAKCmBgYHtyfQp0YWJsZShjbGFzcywgbW9kJGNsYXNzaWZpY2F0aW9uKQoKIyMgQW5ub3RhdGUgY2x1c3RlcnMKbWNfY2x1c3RlcnMgPC0gZmFjdG9yKG1vZCRjbGFzc2lmaWNhdGlvbikKYGBgCgpgYGB7cn0KcGxvdChtb2QsIHdoYXQgPSAiQklDIiwgeWxpbSA9IHJhbmdlKG1vZCRCSUNbLCAtKDE6MildLCBuYS5ybSA9IFRSVUUpLAogIGxlZ2VuZEFyZ3MgPSBsaXN0KHggPSAiYm90dG9tbGVmdCIpCikKcGxvdChtb2QsIHdoYXQgPSAiY2xhc3NpZmljYXRpb24iKQpgYGAKClRoZXJlIGlzIGEgY2xlYXIgaW5kaWNhdGlvbiBvZiBhIHRocmVlLWNvbXBvbmVudCBtaXh0dXJlIHdpdGggY292YXJpYW5jZXMgaGF2aW5nCmRpZmZlcmVudCBzaGFwZXMgYW5kIHZvbHVtZXMgYnV0IHRoZSBzYW1lIG9yaWVudGF0aW9uIChWVkUpLiBTZWUKYD9tY2x1c3RNb2RlbE5hbWVzYCBmb3IgYSBkZXNjcmlwdGlvbiBvZiB0aGUgZGlmZmVyZW50IGBtY2x1c3RgIG1vZGVscy4KCjwvZGV0YWlscz4KCiMjIyMgMi4gVmlzdWFsaXplIHRoZSBjbHVzdGVycyBmb3VuZCBieSBgTWNsdXN0KClgIG9uIHRoZSBQQ0EgYmlwbG90LiBDb21wYXJlIHdpdGggdGhlIG9yaWdpbmFsIGxhYmVscy4gey19Cgo8ZGV0YWlscz48c3VtbWFyeT5Tb2x1dGlvbjwvc3VtbWFyeT4KCmBgYHtyLCBmaWcuYXNwPTF9CmdnYmlwbG90KHdpbmVfcGNhLCBncm91cHMgPSBjbGFzcykgKwogIHNjYWxlX2NvbG9yX2JyZXdlcihwYWxldHRlID0gIlNldDIiKSArCiAgbGFicyhjb2xvciA9ICJPcmlnaW5hbCBsYWJlbHMiKSArCiAgdGhlbWUoYXNwZWN0LnJhdGlvID0gMC44LCBsZWdlbmQucG9zaXRpb24gPSAidG9wIikKCiMjIFBDQSBwbG90IGFubm90YXRlZCB3aXRoIGNsdXN0ZXJzCmdnYmlwbG90KHdpbmVfcGNhLCBncm91cHMgPSBtY19jbHVzdGVycykgKwogIGxhYnMoY29sb3IgPSAibWNsdXN0IGNsdXN0ZXJzIikgKwogIHNjYWxlX2NvbG9yX2JyZXdlcihwYWxldHRlID0gIlNldDIiKSArCiAgdGhlbWUoYXNwZWN0LnJhdGlvID0gMC44LCBsZWdlbmQucG9zaXRpb24gPSAidG9wIikKYGBgCgo8L2RldGFpbHM+CgojIyMjIDMuIFBlcmZvcm0gYSBkaW1lbnNpb25hbGl0eSByZWR1Y3Rpb24gb2YgdGhlIHdpbmUgZGF0YSB1c2luZyB0aGUgUENBLiBTZWxlY3QgYW4gYXBwcm9wcmlhdGUgbnVtYmVyIG9mIFBDJ3MuIFJlZG8gdGhlIGNsdXN0ZXJpbmcgb24gdGhpcyByZWR1Y2VkIGRpbWVuc2lvbiByZXByZXNlbnRhdGlvbiBhbmQgbWFrZSB0aGUgc2FtZSBmaWd1cmVzIGFzIGJlZm9yZS4gSG93IGRvIHRoZSByZXN1bHRzIGRpZmZlcj8gey19Cgo8ZGV0YWlscz48c3VtbWFyeT5Tb2x1dGlvbjwvc3VtbWFyeT4KCmBgYHtyfQojIyBDYWxjdWxhdGUgdG90YWwgdmFyaWFuY2UgYnkgc3VtbWluZyB0aGUgUEMgdmFyaWFuY2VzIChzZGV2J3Mgc3F1YXJlZCkKdG90X3ZhciA8LSBzdW0od2luZV9wY2Ekc2Rldl4yKQoKIyMgQ3JlYXRlIGRhdGEuZnJhbWUgb2YgdGhlIHByb3BvcnRpb24gb2YgdmFyaWFuY2UgZXhwbGFpbmVkIGJ5IGVhY2ggUEMKd2luZV9wcm9wX3ZhciA8LSBkYXRhLmZyYW1lKAogIFBDID0gMTpuY29sKHdpbmVfcGNhJHgpLAogIHZhciA9IHdpbmVfcGNhJHNkZXZeMgopICU+JQogICMjIFVzaW5nIGBtdXRhdGVgIHRvIGNhbGN1bGF0ZSBwcm9wLiB2YXIgYW5kIGN1bS4gcHJvcC4gdmFyCiAgbXV0YXRlKAogICAgcHJvcF92YXIgPSB2YXIgLyB0b3RfdmFyLAogICAgY3VtX3Byb3BfdmFyID0gY3Vtc3VtKHZhciAvIHRvdF92YXIpCiAgKQoKd2luZV9wcm9wX3ZhcgoKIyMgUGxvdCB0aGUgcHJvcG9ydGlvbiBvZiB2YXJpYW5jZSBleHBsYWluZWQgYnkgZWFjaCBQQwpwMSA8LSBnZ3Bsb3Qod2luZV9wcm9wX3ZhciwgYWVzKFBDLCBwcm9wX3ZhcikpICsKICBnZW9tX3BvaW50KCkgKwogIGdlb21fbGluZSgpICsKICBnZW9tX3ZsaW5lKHhpbnRlcmNlcHQgPSA2LjUsIGNvbCA9ICJmaXJlYnJpY2siKSArCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcyA9IDE6bmNvbCh3aW5lX3BjYSR4KSkgKwogIGxhYnMoeSA9ICJQcm9wb3J0aW9uIG9mIHZhcmlhbmNlIikKCiMjIFBsb3QgdGhlIGN1bXVsYXRpdmUgcHJvcG9ydGlvbiBvZiB2YXJpYW5jZSBleHBsYWluZWQgYnkgZWFjaCBQQwpwMiA8LSBnZ3Bsb3Qod2luZV9wcm9wX3ZhciwgYWVzKFBDLCBjdW1fcHJvcF92YXIpKSArCiAgZ2VvbV9wb2ludCgpICsKICBnZW9tX2xpbmUoKSArCiAgZ2VvbV92bGluZSh4aW50ZXJjZXB0ID0gNi41LCBjb2wgPSAiZmlyZWJyaWNrIikgKwogIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSAxOm5jb2wod2luZV9wY2EkeCkpICsKICBsYWJzKHkgPSAiQ3VtdWxhdGl2ZSBwcm9wb3J0aW9uIG9mIHZhcmlhbmNlIikKCmdyaWRFeHRyYTo6Z3JpZC5hcnJhbmdlKHAxLCBwMiwgbmNvbCA9IDIpCmBgYAoKU2VsZWN0aW5nIGZpcnN0IDYgUEMncywga2VlcGluZyA4NSUgb2YgdGhlIHZhcmlhbmNlLgoKYGBge3J9CmsgPC0gNgpwY2FfWCA8LSB3aW5lX3BjYSR4WywgMTprXQpoZWFkKHBjYV9YKQpgYGAKCmBgYHtyfQptb2QyIDwtIE1jbHVzdChwY2FfWCkKc3VtbWFyeShtb2QyKQpzdW1tYXJ5KG1vZDIkQklDKQpgYGAKCmBgYHtyfQp0YWJsZShjbGFzcywgbW9kMiRjbGFzc2lmaWNhdGlvbikKCiMjIEFubm90YXRlIGNsdXN0ZXJzCm1jX3BjYV9jbHVzdGVycyA8LSBmYWN0b3IobW9kMiRjbGFzc2lmaWNhdGlvbikKYGBgCgpgYGB7ciwgZmlnLmFzcD0wLjh9CnBsb3QobW9kMiwgd2hhdCA9ICJCSUMiLCB5bGltID0gcmFuZ2UobW9kMiRCSUNbLCAtKDE6MildLCBuYS5ybSA9IFRSVUUpLAogIGxlZ2VuZEFyZ3MgPSBsaXN0KHggPSAiYm90dG9tbGVmdCIpCikKYGBgCgpgYGB7ciwgZmlnLmFzcD0xfQpkZiA8LSBhcy5kYXRhLmZyYW1lKHBjYV9YKQpkZiRjbHVzdGVycyA8LSBtY19wY2FfY2x1c3RlcnMKCiMjIFVzaW5nIGdnc2NhdG1hdCgpIGZyb20gR0dhbGx5IHBhY2thZ2UgdG8gcGxvdCBhbGwgcGFpcndpc2UgUENzCmdnc2NhdG1hdChkZiwgY29sdW1ucyA9IDE6aywgY29sb3IgPSAiY2x1c3RlcnMiKSArCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gImJvdHRvbSIsIGFzcGVjdC5yYXRpbyA9IDAuNikgKwogIHNjYWxlX2NvbG9yX2JyZXdlcihwYWxldHRlID0gIlNldDIiLCBuYW1lID0gIm1jbHVzdC1QQ0EgY2x1c3RlcnMiKQpgYGAKCipOb3RlOiB5b3UgY2FuIGlnbm9yZSB0aGUgdXBwZXItcmlnaHQgcGFuZWxzIG9mIHRoaXMgZmlndXJlLiBUaGVzZSBnaXZlIHRoZSBjb3JyZWxhdGlvbnMgYmV0d2VlbiBlYWNoIHBhaXIgb2YgdmFyaWFibGVzIChQQydzIGhlcmUpIGZvciBlYWNoIGdyb3VwLCBidXQgYXJlIG5vdCByZWxldmFudCBoZXJlLioKCjwvZGV0YWlscz4KCgoKYGBge3IsIGNoaWxkPSJfc2Vzc2lvbi1pbmZvLlJtZCJ9CmBgYAoKW3dpbmVdOiBodHRwczovL3JkcnIuaW8vY3Jhbi9nY2x1cy9tYW4vd2luZS5odG1sCltzY3J1Y2NhMjAxNl06IGh0dHBzOi8vc3ZuLnItcHJvamVjdC5vcmcvUmpvdXJuYWwvaHRtbC9hcmNoaXZlLzIwMTYvUkotMjAxNi0wMjEvUkotMjAxNi0wMjEucGRmClttY2x1c3RdOiBodHRwczovL3JkcnIuaW8vY3Jhbi9tY2x1c3QvbWFuL01jbHVzdC5odG1sCg==</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Lab5-Clustering.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
