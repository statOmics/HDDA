<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Milan Malfait and Leo Fuhrhop" />


<title>Lab 5: Clustering</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>

<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">HDDA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="intro.html">1. Introduction</a>
    </li>
    <li>
      <a href="svd.html">2. Singular Value Decomposition</a>
    </li>
    <li>
      <a href="prediction.html">3. Prediction with High Dimensional Predictors</a>
    </li>
    <li>
      <a href="sparseSvd.html">4. Sparse Singular Value Decomposition</a>
    </li>
    <li>
      <a href="lda.html">5. Linear Discriminant Analysis</a>
    </li>
    <li>
      <a href="hclust.html">6.1. Introduction to Clustering</a>
    </li>
    <li>
      <a href="https://sites.stat.washington.edu/people/raftery/Research/PDF/fraley1998.pdf">6.2. Paper Model-based Clustering</a>
    </li>
    <li>
      <a href="em.html">6.3. EM algorithm</a>
    </li>
    <li>
      <a href="lsi.html">7. Large Scale Inference</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lab1-Intro-SVD.html">Lab 1: Intro &amp; SVD</a>
    </li>
    <li>
      <a href="Lab2-PCA.html">Lab 2: SVD - PCA</a>
    </li>
    <li>
      <a href="Lab3-Penalized-Regression.html">Lab 3: Prediction</a>
    </li>
    <li>
      <a href="Lab4-Sparse-PCA-LDA.html">Lab 4: Sparse PCA &amp; LDA</a>
    </li>
    <li>
      <a href="Lab5-Clustering.html">Lab 5: Clustering</a>
    </li>
    <li>
      <a href="Lab6-Large-Scale-Inference.html">Lab 6: LSI</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="https://github.com/statOmics/HDDA">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Lab 5: Clustering</h1>
<h3 class="subtitle">High Dimensional Data Analysis practicals</h3>
<h4 class="author">Milan Malfait and Leo Fuhrhop</h4>
<h4 class="date">24 Feb 2022 <br/> (Last updated: 2025-11-09)</h4>

</div>


<div id="change-log" class="section level3 unnumbered">
<h3><a href="https://github.com/statOmics/HDDA/commits/master/Lab6-Clustering.Rmd">Change log</a></h3>
<hr />
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## Install necessary packages with:</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># install.packages(c(&quot;mclust&quot;, &quot;gclus&quot;, &quot;tidyverse&quot;, &quot;gridExtra&quot;))</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># if (!requireNamespace(&quot;remotes&quot;, quietly = TRUE)) {</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#     install.packages(&quot;remotes&quot;)</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;vqv/ggbiplot&quot;)</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">library</span>(mclust)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="fu">library</span>(gclus)  <span class="co"># contains the &#39;wine&#39; data</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="fu">library</span>(ggbiplot)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span></code></pre></div>
</div>
<div id="the-wine-data" class="section level1" number="1">
<h1><span class="header-section-number">1</span> The wine data</h1>
<p>In this lab session, we will explore the <a href="https://rdrr.io/cran/gclus/man/wine.html"><code>wine</code></a> data, following the
example analysis from <a href="https://svn.r-project.org/Rjournal/html/archive/2016/RJ-2016-021/RJ-2016-021.pdf">Scrucca <em>et al.</em> (2016)</a>.</p>
<p>This dataset provides 13 measurements obtained from a chemical analysis of 178
wines grown in the same region in Italy but derived from three different
cultivars (Barolo, Grignolino, Barbera). The original cultivar labels are
provided in the dataset.</p>
<p>We will apply different clustering algorithms and validate them by comparing how
well the clusters capture the original classes.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;wine&quot;</span>, <span class="at">package =</span> <span class="st">&quot;gclus&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>class <span class="ot">&lt;-</span> <span class="fu">factor</span>(wine<span class="sc">$</span>Class, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Barolo&quot;</span>, <span class="st">&quot;Grignolino&quot;</span>, <span class="st">&quot;Barbera&quot;</span>))</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">table</span>(class)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; class</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;     Barolo Grignolino    Barbera </span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt;         59         71         48</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(wine[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="fu">summary</span>(X)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt;     Alcohol          Malic            Ash          Alcalinity   </span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt;  Min.   :11.03   Min.   :0.740   Min.   :1.360   Min.   :10.60  </span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:12.36   1st Qu.:1.603   1st Qu.:2.210   1st Qu.:17.20  </span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt;  Median :13.05   Median :1.865   Median :2.360   Median :19.50  </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt;  Mean   :13.00   Mean   :2.336   Mean   :2.367   Mean   :19.49  </span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:13.68   3rd Qu.:3.083   3rd Qu.:2.558   3rd Qu.:21.50  </span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt;  Max.   :14.83   Max.   :5.800   Max.   :3.230   Max.   :30.00  </span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt;    Magnesium         Phenols        Flavanoids     Nonflavanoid   </span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt;  Min.   : 70.00   Min.   :0.980   Min.   :0.340   Min.   :0.1300  </span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: 88.00   1st Qu.:1.742   1st Qu.:1.205   1st Qu.:0.2700  </span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt;  Median : 98.00   Median :2.355   Median :2.135   Median :0.3400  </span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt;  Mean   : 99.74   Mean   :2.295   Mean   :2.029   Mean   :0.3619  </span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:107.00   3rd Qu.:2.800   3rd Qu.:2.875   3rd Qu.:0.4375  </span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt;  Max.   :162.00   Max.   :3.880   Max.   :5.080   Max.   :0.6600  </span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt;  Proanthocyanins   Intensity           Hue             OD280      </span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt;  Min.   :0.410   Min.   : 1.280   Min.   :0.4800   Min.   :1.270  </span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:1.250   1st Qu.: 3.220   1st Qu.:0.7825   1st Qu.:1.938  </span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt;  Median :1.555   Median : 4.690   Median :0.9650   Median :2.780  </span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt;  Mean   :1.591   Mean   : 5.058   Mean   :0.9575   Mean   :2.612  </span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:1.950   3rd Qu.: 6.200   3rd Qu.:1.1200   3rd Qu.:3.170  </span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt;  Max.   :3.580   Max.   :13.000   Max.   :1.7100   Max.   :4.000  </span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">#&gt;     Proline      </span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co">#&gt;  Min.   : 278.0  </span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: 500.5  </span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="co">#&gt;  Median : 673.5  </span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="co">#&gt;  Mean   : 746.9  </span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 985.0  </span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="co">#&gt;  Max.   :1680.0</span></span></code></pre></div>
<p>We will use a PCA to visualize the data, along with the class labels, in a low-dimensional space.
This will allow us to interpret the results of the clustering algorithms more easily.</p>
<div id="tasks" class="section level3 unnumbered">
<h3>Tasks</h3>
<div id="perform-a-pca-of-the-scaled-wine-data." class="section level4 unnumbered">
<h4>1. Perform a PCA of the scaled <code>wine</code> data.</h4>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>wine_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(X, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</details>
</div>
<div id="create-a-biplot-of-the-first-two-pcs.-color-each-observation-by-its-class-label.-interpret-the-pcs.-how-distinguishable-are-the-classes-with-respect-to-the-pcs" class="section level4 unnumbered">
<h4>2. Create a biplot of the first two PCs. Color each observation by its class label. Interpret the PCs. How distinguishable are the classes with respect to the PCs?</h4>
<details>
<summary>
Solution
</summary>
<p>Using <code>ggbiplot</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Barolo&quot;</span> <span class="ot">=</span> <span class="st">&quot;#28a028&quot;</span>, <span class="st">&quot;Grignolino&quot;</span> <span class="ot">=</span> <span class="st">&quot;#da6852&quot;</span>, <span class="st">&quot;Barbera&quot;</span> <span class="ot">=</span> <span class="st">&quot;#0078cd&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">ggbiplot</span>(wine_pca, <span class="at">groups =</span> class) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cols) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;True labels&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.8</span>, <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Alternatively, using base <code>R</code> plotting:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>Zk <span class="ot">&lt;-</span> wine_pca<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>Vk <span class="ot">&lt;-</span> wine_pca<span class="sc">$</span>rotation[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">plot</span>(Zk, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">col =</span> cols[class],</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PC2&quot;</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">levels</span>(class),</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="at">col =</span> cols,</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># rescaling</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>) {</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="at">length =</span> <span class="fl">0.2</span>, <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  <span class="fu">text</span>(alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="fu">rownames</span>(Vk)[i], <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p><strong>Interpretation</strong>: Low values on PC1 correspond to heavier, aged, more structured wines, while high values indicate fresher, less heavy, younger wines.
High values on PC2 correspond to lighter-colored wines with lower alcohol content.
Importantly, the three classes are quite clearly visually separated with little overlap between them. We can thus rely on the biplot to visually investigate how well a clustering algorithm recovers the true classes.</p>
</details>
</div>
</div>
</div>
<div id="hierarchical-clustering" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Hierarchical clustering</h1>
<div id="tasks-1" class="section level3 unnumbered">
<h3>Tasks</h3>
<div id="perform-hierarchical-clustering-of-the-wine-data-using-a-euclidean-distance-matrix-and-the-complete-linkage-algorithm-see-hclust." class="section level4 unnumbered">
<h4>1. Perform hierarchical clustering of the wine data, using a Euclidean distance matrix and the complete-linkage algorithm (see <code>?hclust</code>).</h4>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Calculate distance matrix and perform hierarchical clustering</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>wine_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(X, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(wine_dist, <span class="at">method =</span> <span class="st">&quot;complete&quot;</span>)</span></code></pre></div>
</details>
</div>
<div id="plot-the-clustering-dendrogram." class="section level4 unnumbered">
<h4>2. Plot the clustering <em>dendrogram</em>.</h4>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(hc, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</details>
</div>
<div id="use-cutree-to-select-three-clusters-from-the-hierarchical-clustering.-recreate-the-pca-biplot-from-section-1-but-color-each-observation-according-to-its-cluster.-compare-the-resulting-biplot-to-the-earlier-one-from-section-1." class="section level4 unnumbered">
<h4>3. Use <code>cutree</code> to select three clusters from the hierarchical clustering. Recreate the PCA biplot from Section 1, but color each observation according to its cluster. Compare the resulting biplot to the earlier one from Section 1.</h4>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Select three clusters</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>hc_clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># Tabulate clusters against true classes</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">table</span>(class, hc_clusters)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt;             hc_clusters</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; class         1  2  3</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt;   Barolo     43 16  0</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt;   Grignolino  0 15 56</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt;   Barbera     0 21 27</span></span></code></pre></div>
<p>Biplot with <code>ggbiplot</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggbiplot</span>(wine_pca, <span class="at">groups =</span> class) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cols) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;True labels&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.8</span>, <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggbiplot</span>(wine_pca, <span class="at">groups =</span> <span class="fu">factor</span>(hc_clusters)) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#9d05f4&quot;</span>, <span class="st">&quot;#01d9d9&quot;</span>, <span class="st">&quot;#f4dc00&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;HC clusters&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.8</span>, <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, <span class="fu">nullGrob</span>(), plot2, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Alternatively, using base <code>R</code> plotting:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co"># True class labels</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">plot</span>(Zk, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="at">col =</span> cols[class],</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PC2&quot;</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">levels</span>(class),</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="at">col =</span> cols,</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># rescaling</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>) {</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="at">length =</span> <span class="fl">0.2</span>, <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>  <span class="fu">text</span>(alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="fu">rownames</span>(Vk)[i], <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>}</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>cluster_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#9d05f4&quot;</span>, <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;#01d9d9&quot;</span>, <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="st">&quot;#f4dc00&quot;</span>)</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="co"># Clusters</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="fu">plot</span>(Zk, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>  <span class="at">col =</span> cluster_cols[<span class="fu">factor</span>(hc_clusters)],</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PC2&quot;</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>)</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">levels</span>(<span class="fu">factor</span>(hc_clusters)),</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>  <span class="at">col =</span> cluster_cols,</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>)</span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># rescaling</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>) {</span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="at">length =</span> <span class="fl">0.2</span>, <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>  <span class="fu">text</span>(alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="fu">rownames</span>(Vk)[i], <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p><strong>Interpretation</strong>: The first cluster corresponds to most of the Barolo class, but the second cluster overlaps with all three classes, and the third cluster captures wines from both the Grignolino and the Barbera class.
Overall, the three clusters do not recover the true class labels.</p>
</details>
</div>
<div id="bonus-can-you-improve-the-results-by-using-different-distance-metrics-or-linkages" class="section level4 unnumbered">
<h4>Bonus: can you improve the results by using different distance metrics or linkages?</h4>
</div>
</div>
</div>
<div id="model-based-clustering" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Model-based clustering</h1>
<div id="tasks-2" class="section level3 unnumbered">
<h3>Tasks</h3>
<div id="use-mclustmclust-to-perform-model-based-clustering-on-the-wine-data." class="section level4 unnumbered">
<h4>1. Use <code>mclust::Mclust()</code> to perform model-based clustering on the <code>wine</code> data.</h4>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(X)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">summary</span>(mc)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------- </span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; Gaussian finite mixture model fitted by EM algorithm </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------- </span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; Mclust VVE (ellipsoidal, equal orientation) model with 3 components: </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt;  log-likelihood   n  df       BIC       ICL</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt;       -3015.335 178 158 -6849.391 -6850.734</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; Clustering table:</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt;  1  2  3 </span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; 59 69 50</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="fu">summary</span>(mc<span class="sc">$</span>BIC)</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; Best BIC values:</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt;              VVE,3       EVE,4       VVE,4</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; BIC      -6849.391 -6873.61648 -6885.47222</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; BIC diff     0.000   -24.22499   -36.08073</span></span></code></pre></div>
</details>
</div>
<div id="visualize-the-clustering-via-pairwise-plots.-plot-the-bic-bayesian-information-criterion-values-and-interpret-the-results." class="section level4 unnumbered">
<h4>2. Visualize the clustering via pairwise plots. Plot the BIC (Bayesian information criterion) values and interpret the results.</h4>
<p>Hint: Check <code>?plot.Mclust</code>.</p>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Pairwise clustering plots</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">plot</span>(mc, <span class="at">what =</span> <span class="st">&quot;classification&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># BIC plot; exclude two models with very low BIC</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="fu">plot</span>(mc, <span class="at">what =</span> <span class="st">&quot;BIC&quot;</span>, <span class="at">ylim =</span> <span class="fu">range</span>(mc<span class="sc">$</span>BIC[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="at">legendArgs =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">&quot;bottomleft&quot;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-11-1.png" width="672" /><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<p><strong>Interpretation</strong>: A three-component mixture with covariances having
different shapes and volumes but the same orientation (VVE) results in the
highest BIC.</p>
</details>
</div>
<div id="recreate-the-pca-biplot-from-section-1-but-color-each-observation-according-to-its-cluster.-compare-the-resulting-biplot-to-the-earlier-ones." class="section level4 unnumbered">
<h4>3. Recreate the PCA biplot from Section 1, but color each observation according to its cluster. Compare the resulting biplot to the earlier ones.</h4>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Tabulate clusters against true classes</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">table</span>(class, mc<span class="sc">$</span>classification)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt;             </span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; class         1  2  3</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt;   Barolo     59  0  0</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt;   Grignolino  0 69  2</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt;   Barbera     0  0 48</span></span></code></pre></div>
<p>Biplot with <code>ggbiplot</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggbiplot</span>(wine_pca, <span class="at">groups =</span> class) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cols) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;True labels&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.8</span>, <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggbiplot</span>(wine_pca, <span class="at">groups =</span> <span class="fu">factor</span>(mc<span class="sc">$</span>classification)) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#9d05f4&quot;</span>, <span class="st">&quot;#01d9d9&quot;</span>, <span class="st">&quot;#f4dc00&quot;</span>)) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Mclust clusters&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.8</span>, <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, <span class="fu">nullGrob</span>(), plot2, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Alternatively, using base <code>R</code> plotting:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co"># True class labels</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="fu">plot</span>(Zk, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="at">col =</span> cols[class],</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PC2&quot;</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">levels</span>(class),</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  <span class="at">col =</span> cols,</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># rescaling</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>) {</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="at">length =</span> <span class="fl">0.2</span>, <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>  <span class="fu">text</span>(alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="fu">rownames</span>(Vk)[i], <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>}</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>cluster_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#9d05f4&quot;</span>, <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;#01d9d9&quot;</span>, <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="st">&quot;#f4dc00&quot;</span>)</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co"># Clusters</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="fu">plot</span>(Zk, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>  <span class="at">col =</span> cluster_cols[<span class="fu">factor</span>(mc<span class="sc">$</span>classification)],</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PC2&quot;</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>)</span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">levels</span>(<span class="fu">factor</span>(mc<span class="sc">$</span>classification)),</span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>  <span class="at">col =</span> cluster_cols,</span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>)</span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># rescaling</span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>) {</span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="at">length =</span> <span class="fl">0.2</span>, <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a>  <span class="fu">text</span>(alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="fu">rownames</span>(Vk)[i], <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p><strong>Interpretation</strong>: The first cluster corresponds to the Barolo class, the second cluster to the Grignolino class and the third cluster to Barbera.
Overall, the three clusters recover the true class labels very well, with only two Grignolino wines falsely assigned to the third cluster (Barbera).</p>
</details>
</div>
<div id="select-an-appropriate-number-of-pcs-from-the-pca.-repeat-the-model-based-clustering-on-the-pcs.-how-do-the-results-compare-to-those-on-the-full-data" class="section level4 unnumbered">
<h4>4. Select an appropriate number of PCs from the PCA. Repeat the model-based clustering on the PCs. How do the results compare to those on the full data?</h4>
<details>
<summary>
Solution
</summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Proportion of variance explained by each PC</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>wine_prop_var <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="at">PC =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(wine_pca<span class="sc">$</span>x),</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="at">var =</span> wine_pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(wine_pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="fu">ggplot</span>(wine_prop_var, <span class="fu">aes</span>(PC, var)) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">7.5</span>, <span class="at">col =</span> <span class="st">&quot;firebrick&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(wine_pca<span class="sc">$</span>x)) <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Proportion of variance&quot;</span>)</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>The first 7 PCs explain about 92% of the variance in the <code>wine</code> data.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Select the first k PCs</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>pca_X <span class="ot">&lt;-</span> wine_pca<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span>k]</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co"># Refit the model-based clustering</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>mc2 <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(pca_X)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="fu">summary</span>(mc2)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------- </span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt; Gaussian finite mixture model fitted by EM algorithm </span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------- </span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; Mclust VEI (diagonal, equal shape) model with 5 components: </span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt;  log-likelihood   n df       BIC       ICL</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt;       -1719.764 178 50 -3698.617 -3725.317</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; Clustering table:</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt;  1  2  3  4  5 </span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; 53 25 19 34 47</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="fu">summary</span>(mc2<span class="sc">$</span>BIC)</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; Best BIC values:</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt;              VEI,5        VEI,4        VEI,6</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; BIC      -3698.617 -3700.939851 -3704.927637</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; BIC diff     0.000    -2.322571    -6.310357</span></span></code></pre></div>
<p>A five-component mixture with diagonal covariances having equal shape, but
varying volume (VEI), results in the highest BIC.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Tabulate clusters against true classes</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">table</span>(class, mc2<span class="sc">$</span>classification)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt;             </span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; class         1  2  3  4  5</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt;   Barolo     53  6  0  0  0</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt;   Grignolino  0 16 18 34  3</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt;   Barbera     0  3  1  0 44</span></span></code></pre></div>
<p>Biplot with <code>ggbiplot</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggbiplot</span>(wine_pca, <span class="at">groups =</span> class) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cols) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;True labels&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.8</span>, <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggbiplot</span>(wine_pca, <span class="at">groups =</span> <span class="fu">factor</span>(mc2<span class="sc">$</span>classification)) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#9d05f4&quot;</span>, <span class="st">&quot;#01d9d9&quot;</span>, <span class="st">&quot;#01d9d9&quot;</span>, <span class="st">&quot;#01d9d9&quot;</span>, <span class="st">&quot;#f4dc00&quot;</span>)) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Mclust clusters&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.8</span>, <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, <span class="fu">nullGrob</span>(), plot2, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Alternatively, using base <code>R</code> plotting:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co"># True class labels</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="fu">plot</span>(Zk, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="at">col =</span> cols[class],</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PC2&quot;</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">levels</span>(class),</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="at">col =</span> cols,</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>)</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># rescaling</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>) {</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="at">length =</span> <span class="fl">0.2</span>, <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>  <span class="fu">text</span>(alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="fu">rownames</span>(Vk)[i], <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>}</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>cluster_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#9d05f4&quot;</span>, <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;#01d9d9&quot;</span>, <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="st">&quot;#01d9d9&quot;</span>, <span class="st">&quot;4&quot;</span> <span class="ot">=</span> <span class="st">&quot;#01d9d9&quot;</span>, <span class="st">&quot;5&quot;</span> <span class="ot">=</span> <span class="st">&quot;#f4dc00&quot;</span>)</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a><span class="co"># Clusters</span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="fu">plot</span>(Zk, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>  <span class="at">col =</span> cluster_cols[<span class="fu">factor</span>(mc2<span class="sc">$</span>classification)],</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PC2&quot;</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>)</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">levels</span>(<span class="fu">factor</span>(mc2<span class="sc">$</span>classification)),</span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>  <span class="at">col =</span> cluster_cols,</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a>)</span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># rescaling</span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>) {</span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="at">length =</span> <span class="fl">0.2</span>, <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a>  <span class="fu">text</span>(alpha <span class="sc">*</span> Vk[i, <span class="dv">1</span>], alpha <span class="sc">*</span> Vk[i, <span class="dv">2</span>], <span class="fu">rownames</span>(Vk)[i], <span class="at">col =</span> <span class="st">&quot;#8f4040&quot;</span>)</span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Lab5-Clustering_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p><strong>Interpretation</strong>: The first cluster corresponds to most of the Barolo class. The fifth color mainly corresponds to the Barbera class, while containing a few Grignolino wines.
Combining the second, third and fourth cluster recovers most of the Grignolino class, with some overlap with the remaining classes.
Overall, after combining the three smaller clusters, the clustering recovers the true class labels fairly well, though not quite as closely as the clustering on the original data.</p>
</details>
</div>
</div>
</div>
<div id="additional-resources" class="section level1 unnumbered">
<h1>Additional resources</h1>
<ul>
<li>Section 14.3 of <span class="citation">Hastie, Tibshirani, and Friedman (2009)</span></li>
</ul>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1>Session info</h1>
<details>
<summary>
Session info
</summary>
<pre><code>#&gt; [1] &quot;2025-11-09 16:06:01 CET&quot;
#&gt;  Session info 
#&gt;  setting  value
#&gt;  version  R version 4.5.2 (2025-10-31)
#&gt;  os       macOS Sequoia 15.6
#&gt;  system   aarch64, darwin20
#&gt;  ui       X11
#&gt;  language (EN)
#&gt;  collate  en_US.UTF-8
#&gt;  ctype    en_US.UTF-8
#&gt;  tz       Europe/Brussels
#&gt;  date     2025-11-09
#&gt;  pandoc   3.6.3 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/aarch64/ (via rmarkdown)
#&gt;  quarto   1.7.32 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/quarto
#&gt; 
#&gt;  Packages 
#&gt;  package      * version date (UTC) lib source
#&gt;  bookdown       0.45    2025-10-03 [1] CRAN (R 4.5.0)
#&gt;  bslib          0.9.0   2025-01-30 [1] CRAN (R 4.5.0)
#&gt;  cachem         1.1.0   2024-05-16 [1] CRAN (R 4.5.0)
#&gt;  cli            3.6.5   2025-04-23 [1] CRAN (R 4.5.0)
#&gt;  cluster      * 2.1.8.1 2025-03-12 [1] CRAN (R 4.5.2)
#&gt;  digest         0.6.37  2024-08-19 [1] CRAN (R 4.5.0)
#&gt;  dplyr        * 1.1.4   2023-11-17 [1] CRAN (R 4.5.0)
#&gt;  evaluate       1.0.5   2025-08-27 [1] CRAN (R 4.5.0)
#&gt;  farver         2.1.2   2024-05-13 [1] CRAN (R 4.5.0)
#&gt;  fastmap        1.2.0   2024-05-15 [1] CRAN (R 4.5.0)
#&gt;  forcats      * 1.0.1   2025-09-25 [1] CRAN (R 4.5.0)
#&gt;  gclus        * 1.3.3   2025-03-28 [1] CRAN (R 4.5.0)
#&gt;  generics       0.1.4   2025-05-09 [1] CRAN (R 4.5.0)
#&gt;  ggbiplot     * 0.55    2025-11-05 [1] Github (vqv/ggbiplot@f7ea76d)
#&gt;  ggplot2      * 4.0.0   2025-09-11 [1] CRAN (R 4.5.0)
#&gt;  glue           1.8.0   2024-09-30 [1] CRAN (R 4.5.0)
#&gt;  gridExtra    * 2.3     2017-09-09 [1] CRAN (R 4.5.0)
#&gt;  gtable         0.3.6   2024-10-25 [1] CRAN (R 4.5.0)
#&gt;  hms            1.1.4   2025-10-17 [1] CRAN (R 4.5.0)
#&gt;  htmltools      0.5.8.1 2024-04-04 [1] CRAN (R 4.5.0)
#&gt;  jquerylib      0.1.4   2021-04-26 [1] CRAN (R 4.5.0)
#&gt;  jsonlite       2.0.0   2025-03-27 [1] CRAN (R 4.5.0)
#&gt;  knitr          1.50    2025-03-16 [1] CRAN (R 4.5.0)
#&gt;  labeling       0.4.3   2023-08-29 [1] CRAN (R 4.5.0)
#&gt;  lifecycle      1.0.4   2023-11-07 [1] CRAN (R 4.5.0)
#&gt;  lubridate    * 1.9.4   2024-12-08 [1] CRAN (R 4.5.0)
#&gt;  magrittr       2.0.4   2025-09-12 [1] CRAN (R 4.5.0)
#&gt;  mclust       * 6.1.2   2025-10-31 [1] CRAN (R 4.5.0)
#&gt;  pillar         1.11.1  2025-09-17 [1] CRAN (R 4.5.0)
#&gt;  pkgconfig      2.0.3   2019-09-22 [1] CRAN (R 4.5.0)
#&gt;  plyr         * 1.8.9   2023-10-02 [1] CRAN (R 4.5.0)
#&gt;  purrr        * 1.2.0   2025-11-04 [1] CRAN (R 4.5.0)
#&gt;  R6             2.6.1   2025-02-15 [1] CRAN (R 4.5.0)
#&gt;  RColorBrewer   1.1-3   2022-04-03 [1] CRAN (R 4.5.0)
#&gt;  Rcpp           1.1.0   2025-07-02 [1] CRAN (R 4.5.0)
#&gt;  readr        * 2.1.5   2024-01-10 [1] CRAN (R 4.5.0)
#&gt;  rlang          1.1.6   2025-04-11 [1] CRAN (R 4.5.0)
#&gt;  rmarkdown      2.30    2025-09-28 [1] CRAN (R 4.5.0)
#&gt;  rstudioapi     0.17.1  2024-10-22 [1] CRAN (R 4.5.0)
#&gt;  S7             0.2.0   2024-11-07 [1] CRAN (R 4.5.0)
#&gt;  sass           0.4.10  2025-04-11 [1] CRAN (R 4.5.0)
#&gt;  scales       * 1.4.0   2025-04-24 [1] CRAN (R 4.5.0)
#&gt;  sessioninfo    1.2.3   2025-02-05 [1] CRAN (R 4.5.0)
#&gt;  stringi        1.8.7   2025-03-27 [1] CRAN (R 4.5.0)
#&gt;  stringr      * 1.6.0   2025-11-04 [1] CRAN (R 4.5.0)
#&gt;  tibble       * 3.3.0   2025-06-08 [1] CRAN (R 4.5.0)
#&gt;  tidyr        * 1.3.1   2024-01-24 [1] CRAN (R 4.5.0)
#&gt;  tidyselect     1.2.1   2024-03-11 [1] CRAN (R 4.5.0)
#&gt;  tidyverse    * 2.0.0   2023-02-22 [1] CRAN (R 4.5.0)
#&gt;  timechange     0.3.0   2024-01-18 [1] CRAN (R 4.5.0)
#&gt;  tzdb           0.5.0   2025-03-15 [1] CRAN (R 4.5.0)
#&gt;  vctrs          0.6.5   2023-12-01 [1] CRAN (R 4.5.0)
#&gt;  withr          3.0.2   2024-10-28 [1] CRAN (R 4.5.0)
#&gt;  xfun           0.54    2025-10-30 [1] CRAN (R 4.5.0)
#&gt;  yaml           2.3.10  2024-07-26 [1] CRAN (R 4.5.0)
#&gt; 
#&gt;  [1] /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library
#&gt;  *  Packages attached to the search path.
#&gt; 
#&gt; </code></pre>
</details>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-esl-book" class="csl-entry">
Hastie, Trevor, Robert Tibshirani, and Jerome Friedman. 2009. <em>The Elements of Statistical Learning</em>. 2nd ed. Springer.
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiTGFiIDU6IENsdXN0ZXJpbmciCnN1YnRpdGxlOiAiSGlnaCBEaW1lbnNpb25hbCBEYXRhIEFuYWx5c2lzIHByYWN0aWNhbHMiCmF1dGhvcjogIk1pbGFuIE1hbGZhaXQgYW5kIExlbyBGdWhyaG9wIgpkYXRlOiAiMjQgRmViIDIwMjIgPGJyLz4gKExhc3QgdXBkYXRlZDogMjAyNS0xMS0wOSkiCnJlZmVyZW5jZXM6Ci0gaWQ6IGVzbC1ib29rCiAgdHlwZTogYm9vawogIGF1dGhvcjoKICAtIGZhbWlseTogSGFzdGllCiAgICBnaXZlbjogVHJldm9yCiAgLSBmYW1pbHk6IFRpYnNoaXJhbmkKICAgIGdpdmVuOiBSb2JlcnQKICAtIGZhbWlseTogRnJpZWRtYW4KICAgIGdpdmVuOiBKZXJvbWUKICBpc3N1ZWQ6CiAgLSB5ZWFyOiAyMDA5CiAgdGl0bGU6IFRoZSBFbGVtZW50cyBvZiBTdGF0aXN0aWNhbCBMZWFybmluZwogIHB1Ymxpc2hlcjogU3ByaW5nZXIKICBlZGl0aW9uOiAybmQKLS0tCgpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRSwgY2FjaGU9RkFMU0V9CmtuaXRyOjpvcHRzX2NodW5rJHNldCgKICBjb2xsYXBzZSA9IFRSVUUsCiAgY29tbWVudCA9ICIjPiIsCiAgZmlnLnNob3cgPSAiaG9sZCIKKQoKb3B0aW9ucyh3aWR0aCA9IDgwKQpgYGAKCiMjIyBbQ2hhbmdlIGxvZ10oaHR0cHM6Ly9naXRodWIuY29tL3N0YXRPbWljcy9IRERBL2NvbW1pdHMvbWFzdGVyL0xhYjYtQ2x1c3RlcmluZy5SbWQpIHstfQoKKioqCgpgYGB7ciBsaWJyYXJpZXMsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CiMjIEluc3RhbGwgbmVjZXNzYXJ5IHBhY2thZ2VzIHdpdGg6CgojIGluc3RhbGwucGFja2FnZXMoYygibWNsdXN0IiwgImdjbHVzIiwgInRpZHl2ZXJzZSIsICJncmlkRXh0cmEiKSkKCiMgaWYgKCFyZXF1aXJlTmFtZXNwYWNlKCJyZW1vdGVzIiwgcXVpZXRseSA9IFRSVUUpKSB7CiMgICAgIGluc3RhbGwucGFja2FnZXMoInJlbW90ZXMiKQojIH0KIyByZW1vdGVzOjppbnN0YWxsX2dpdGh1YigidnF2L2dnYmlwbG90IikKCmxpYnJhcnkobWNsdXN0KQpsaWJyYXJ5KGdjbHVzKSAgIyBjb250YWlucyB0aGUgJ3dpbmUnIGRhdGEKbGlicmFyeShnZ2JpcGxvdCkKbGlicmFyeSh0aWR5dmVyc2UpCmxpYnJhcnkoZ3JpZEV4dHJhKQoKdGhlbWVfc2V0KHRoZW1lX21pbmltYWwoKSkKYGBgCgoKIyBUaGUgd2luZSBkYXRhCgpJbiB0aGlzIGxhYiBzZXNzaW9uLCB3ZSB3aWxsIGV4cGxvcmUgdGhlIFtgd2luZWBdW3dpbmVdIGRhdGEsIGZvbGxvd2luZyB0aGUKZXhhbXBsZSBhbmFseXNpcyBmcm9tIFtTY3J1Y2NhICpldCBhbC4qICgyMDE2KV1bc2NydWNjYTIwMTZdLgoKVGhpcyBkYXRhc2V0IHByb3ZpZGVzIDEzIG1lYXN1cmVtZW50cyBvYnRhaW5lZCBmcm9tIGEgY2hlbWljYWwgYW5hbHlzaXMgb2YgMTc4CndpbmVzIGdyb3duIGluIHRoZSBzYW1lIHJlZ2lvbiBpbiBJdGFseSBidXQgZGVyaXZlZCBmcm9tIHRocmVlIGRpZmZlcmVudApjdWx0aXZhcnMgKEJhcm9sbywgR3JpZ25vbGlubywgQmFyYmVyYSkuIFRoZSBvcmlnaW5hbCBjdWx0aXZhciBsYWJlbHMgYXJlCnByb3ZpZGVkIGluIHRoZSBkYXRhc2V0LgoKV2Ugd2lsbCBhcHBseSBkaWZmZXJlbnQgY2x1c3RlcmluZyBhbGdvcml0aG1zIGFuZCB2YWxpZGF0ZSB0aGVtIGJ5IGNvbXBhcmluZyBob3cKd2VsbCB0aGUgY2x1c3RlcnMgY2FwdHVyZSB0aGUgb3JpZ2luYWwgY2xhc3Nlcy4KCmBgYHtyfQpkYXRhKCJ3aW5lIiwgcGFja2FnZSA9ICJnY2x1cyIpCmNsYXNzIDwtIGZhY3Rvcih3aW5lJENsYXNzLCBsZXZlbHMgPSAxOjMsIGxhYmVscyA9IGMoIkJhcm9sbyIsICJHcmlnbm9saW5vIiwgIkJhcmJlcmEiKSkKdGFibGUoY2xhc3MpCgpYIDwtIGFzLm1hdHJpeCh3aW5lWywgLTFdKQpzdW1tYXJ5KFgpCmBgYAoKV2Ugd2lsbCB1c2UgYSBQQ0EgdG8gdmlzdWFsaXplIHRoZSBkYXRhLCBhbG9uZyB3aXRoIHRoZSBjbGFzcyBsYWJlbHMsIGluIGEgbG93LWRpbWVuc2lvbmFsIHNwYWNlLgpUaGlzIHdpbGwgYWxsb3cgdXMgdG8gaW50ZXJwcmV0IHRoZSByZXN1bHRzIG9mIHRoZSBjbHVzdGVyaW5nIGFsZ29yaXRobXMgbW9yZSBlYXNpbHkuCgojIyMgVGFza3Mgey19CgojIyMjIDEuIFBlcmZvcm0gYSBQQ0Egb2YgdGhlIHNjYWxlZCBgd2luZWAgZGF0YS4gey19Cgo8ZGV0YWlscz48c3VtbWFyeT5Tb2x1dGlvbjwvc3VtbWFyeT4KCmBgYHtyfQp3aW5lX3BjYSA8LSBwcmNvbXAoWCwgc2NhbGUuID0gVFJVRSkKYGBgCgo8L2RldGFpbHM+CgojIyMjIDIuIENyZWF0ZSBhIGJpcGxvdCBvZiB0aGUgZmlyc3QgdHdvIFBDcy4gQ29sb3IgZWFjaCBvYnNlcnZhdGlvbiBieSBpdHMgY2xhc3MgbGFiZWwuIEludGVycHJldCB0aGUgUENzLiBIb3cgZGlzdGluZ3Vpc2hhYmxlIGFyZSB0aGUgY2xhc3NlcyB3aXRoIHJlc3BlY3QgdG8gdGhlIFBDcz8gey19Cgo8ZGV0YWlscz48c3VtbWFyeT5Tb2x1dGlvbjwvc3VtbWFyeT4KClVzaW5nIGBnZ2JpcGxvdGA6CgpgYGB7cn0KY29scyA8LSBjKCJCYXJvbG8iID0gIiMyOGEwMjgiLCAiR3JpZ25vbGlubyIgPSAiI2RhNjg1MiIsICJCYXJiZXJhIiA9ICIjMDA3OGNkIikKCmdnYmlwbG90KHdpbmVfcGNhLCBncm91cHMgPSBjbGFzcykgKwogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSBjb2xzKSArCiAgbGFicyhjb2xvciA9ICJUcnVlIGxhYmVscyIpICsKICB0aGVtZShhc3BlY3QucmF0aW8gPSAwLjgsIGxlZ2VuZC5wb3NpdGlvbiA9ICJ0b3AiKQpgYGAKCkFsdGVybmF0aXZlbHksIHVzaW5nIGJhc2UgYFJgIHBsb3R0aW5nOgoKYGBge3J9ClprIDwtIHdpbmVfcGNhJHhbLCAxOjJdClZrIDwtIHdpbmVfcGNhJHJvdGF0aW9uWywgMToyXQoKcGxvdChaaywgcGNoID0gMjAsCiAgY29sID0gY29sc1tjbGFzc10sCiAgeGxhYiA9ICJQQzEiLCB5bGFiID0gIlBDMiIKKQpsZWdlbmQoInRvcGxlZnQiLCBsZXZlbHMoY2xhc3MpLAogIGNvbCA9IGNvbHMsCiAgcGNoID0gMTkKKQphbHBoYSA8LSA1ICMgcmVzY2FsaW5nCmZvciAoaSBpbiAxOjEzKSB7CiAgYXJyb3dzKDAsIDAsIGFscGhhICogVmtbaSwgMV0sIGFscGhhICogVmtbaSwgMl0sIGxlbmd0aCA9IDAuMiwgY29sID0gIiM4ZjQwNDAiKQogIHRleHQoYWxwaGEgKiBWa1tpLCAxXSwgYWxwaGEgKiBWa1tpLCAyXSwgcm93bmFtZXMoVmspW2ldLCBjb2wgPSAiIzhmNDA0MCIpCn0KYGBgCgpfX0ludGVycHJldGF0aW9uX186IExvdyB2YWx1ZXMgb24gUEMxIGNvcnJlc3BvbmQgdG8gaGVhdmllciwgYWdlZCwgbW9yZSBzdHJ1Y3R1cmVkIHdpbmVzLCB3aGlsZSBoaWdoIHZhbHVlcyBpbmRpY2F0ZSBmcmVzaGVyLCBsZXNzIGhlYXZ5LCB5b3VuZ2VyIHdpbmVzLiAKSGlnaCB2YWx1ZXMgb24gUEMyIGNvcnJlc3BvbmQgdG8gbGlnaHRlci1jb2xvcmVkIHdpbmVzIHdpdGggbG93ZXIgYWxjb2hvbCBjb250ZW50LgpJbXBvcnRhbnRseSwgdGhlIHRocmVlIGNsYXNzZXMgYXJlIHF1aXRlIGNsZWFybHkgdmlzdWFsbHkgc2VwYXJhdGVkIHdpdGggbGl0dGxlIG92ZXJsYXAgYmV0d2VlbiB0aGVtLiBXZSBjYW4gdGh1cyByZWx5IG9uIHRoZSBiaXBsb3QgdG8gdmlzdWFsbHkgaW52ZXN0aWdhdGUgaG93IHdlbGwgYSBjbHVzdGVyaW5nIGFsZ29yaXRobSByZWNvdmVycyB0aGUgdHJ1ZSBjbGFzc2VzLiAKCjwvZGV0YWlscz4KCiMgSGllcmFyY2hpY2FsIGNsdXN0ZXJpbmcKCiMjIyBUYXNrcyB7LX0KCiMjIyMgMS4gUGVyZm9ybSBoaWVyYXJjaGljYWwgY2x1c3RlcmluZyBvZiB0aGUgd2luZSBkYXRhLCB1c2luZyBhIEV1Y2xpZGVhbiBkaXN0YW5jZSBtYXRyaXggYW5kIHRoZSBjb21wbGV0ZS1saW5rYWdlIGFsZ29yaXRobSAoc2VlIGA/aGNsdXN0YCkuIHstfQoKPGRldGFpbHM+PHN1bW1hcnk+U29sdXRpb248L3N1bW1hcnk+CgpgYGB7cn0KIyBDYWxjdWxhdGUgZGlzdGFuY2UgbWF0cml4IGFuZCBwZXJmb3JtIGhpZXJhcmNoaWNhbCBjbHVzdGVyaW5nCndpbmVfZGlzdCA8LSBkaXN0KFgsIG1ldGhvZCA9ICJldWNsaWRlYW4iKQpoYyA8LSBoY2x1c3Qod2luZV9kaXN0LCBtZXRob2QgPSAiY29tcGxldGUiKQpgYGAKCjwvZGV0YWlscz4KCiMjIyMgMi4gUGxvdCB0aGUgY2x1c3RlcmluZyAqZGVuZHJvZ3JhbSouIHstfQoKPGRldGFpbHM+PHN1bW1hcnk+U29sdXRpb248L3N1bW1hcnk+CgpgYGB7cn0KcGxvdChoYywgbGFiZWxzID0gRkFMU0UpCmBgYAoKPC9kZXRhaWxzPgoKIyMjIyAzLiBVc2UgYGN1dHJlZWAgdG8gc2VsZWN0IHRocmVlIGNsdXN0ZXJzIGZyb20gdGhlIGhpZXJhcmNoaWNhbCBjbHVzdGVyaW5nLiBSZWNyZWF0ZSB0aGUgUENBIGJpcGxvdCBmcm9tIFNlY3Rpb24gMSwgYnV0IGNvbG9yIGVhY2ggb2JzZXJ2YXRpb24gYWNjb3JkaW5nIHRvIGl0cyBjbHVzdGVyLiBDb21wYXJlIHRoZSByZXN1bHRpbmcgYmlwbG90IHRvIHRoZSBlYXJsaWVyIG9uZSBmcm9tIFNlY3Rpb24gMS4gey19Cgo8ZGV0YWlscz48c3VtbWFyeT5Tb2x1dGlvbjwvc3VtbWFyeT4KCmBgYHtyfQojIFNlbGVjdCB0aHJlZSBjbHVzdGVycwpoY19jbHVzdGVycyA8LSBjdXRyZWUoaGMsIGsgPSAzKQojIFRhYnVsYXRlIGNsdXN0ZXJzIGFnYWluc3QgdHJ1ZSBjbGFzc2VzCnRhYmxlKGNsYXNzLCBoY19jbHVzdGVycykKYGBgCgpCaXBsb3Qgd2l0aCBgZ2diaXBsb3RgOgoKYGBge3J9CnBsb3QxIDwtIGdnYmlwbG90KHdpbmVfcGNhLCBncm91cHMgPSBjbGFzcykgKwogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSBjb2xzKSArCiAgbGFicyhjb2xvciA9ICJUcnVlIGxhYmVscyIpICsKICB0aGVtZShhc3BlY3QucmF0aW8gPSAwLjgsIGxlZ2VuZC5wb3NpdGlvbiA9ICJ0b3AiKQoKcGxvdDIgPC0gZ2diaXBsb3Qod2luZV9wY2EsIGdyb3VwcyA9IGZhY3RvcihoY19jbHVzdGVycykpICsKICBzY2FsZV9jb2xvcl9tYW51YWwodmFsdWVzID0gYygiIzlkMDVmNCIsICIjMDFkOWQ5IiwgIiNmNGRjMDAiKSkgKwogIGxhYnMoY29sb3IgPSAiSEMgY2x1c3RlcnMiKSArCiAgdGhlbWUoYXNwZWN0LnJhdGlvID0gMC44LCBsZWdlbmQucG9zaXRpb24gPSAidG9wIikKCmdyaWQuYXJyYW5nZShwbG90MSwgbnVsbEdyb2IoKSwgcGxvdDIsIG5jb2wgPSAzLCB3aWR0aHMgPSBjKDEsIDAuMSwgMSkpCmBgYAoKQWx0ZXJuYXRpdmVseSwgdXNpbmcgYmFzZSBgUmAgcGxvdHRpbmc6CgpgYGB7cn0KcGFyKG1mcm93ID0gYygxLCAyKSkKCiMgVHJ1ZSBjbGFzcyBsYWJlbHMKcGxvdChaaywgcGNoID0gMjAsCiAgY29sID0gY29sc1tjbGFzc10sCiAgeGxhYiA9ICJQQzEiLCB5bGFiID0gIlBDMiIKKQpsZWdlbmQoInRvcGxlZnQiLCBsZXZlbHMoY2xhc3MpLAogIGNvbCA9IGNvbHMsCiAgcGNoID0gMTkKKQphbHBoYSA8LSA1ICMgcmVzY2FsaW5nCmZvciAoaSBpbiAxOjEzKSB7CiAgYXJyb3dzKDAsIDAsIGFscGhhICogVmtbaSwgMV0sIGFscGhhICogVmtbaSwgMl0sIGxlbmd0aCA9IDAuMiwgY29sID0gIiM4ZjQwNDAiKQogIHRleHQoYWxwaGEgKiBWa1tpLCAxXSwgYWxwaGEgKiBWa1tpLCAyXSwgcm93bmFtZXMoVmspW2ldLCBjb2wgPSAiIzhmNDA0MCIpCn0KCmNsdXN0ZXJfY29scyA8LSBjKCIxIiA9ICIjOWQwNWY0IiwgIjIiID0gIiMwMWQ5ZDkiLCAiMyIgPSAiI2Y0ZGMwMCIpCiMgQ2x1c3RlcnMKcGxvdChaaywgcGNoID0gMjAsCiAgY29sID0gY2x1c3Rlcl9jb2xzW2ZhY3RvcihoY19jbHVzdGVycyldLAogIHhsYWIgPSAiUEMxIiwgeWxhYiA9ICJQQzIiCikKbGVnZW5kKCJ0b3BsZWZ0IiwgbGV2ZWxzKGZhY3RvcihoY19jbHVzdGVycykpLAogIGNvbCA9IGNsdXN0ZXJfY29scywKICBwY2ggPSAxOQopCmFscGhhIDwtIDUgIyByZXNjYWxpbmcKZm9yIChpIGluIDE6MTMpIHsKICBhcnJvd3MoMCwgMCwgYWxwaGEgKiBWa1tpLCAxXSwgYWxwaGEgKiBWa1tpLCAyXSwgbGVuZ3RoID0gMC4yLCBjb2wgPSAiIzhmNDA0MCIpCiAgdGV4dChhbHBoYSAqIFZrW2ksIDFdLCBhbHBoYSAqIFZrW2ksIDJdLCByb3duYW1lcyhWaylbaV0sIGNvbCA9ICIjOGY0MDQwIikKfQpgYGAKCl9fSW50ZXJwcmV0YXRpb25fXzogVGhlIGZpcnN0IGNsdXN0ZXIgY29ycmVzcG9uZHMgdG8gbW9zdCBvZiB0aGUgQmFyb2xvIGNsYXNzLCBidXQgdGhlIHNlY29uZCBjbHVzdGVyIG92ZXJsYXBzIHdpdGggYWxsIHRocmVlIGNsYXNzZXMsIGFuZCB0aGUgdGhpcmQgY2x1c3RlciBjYXB0dXJlcyB3aW5lcyBmcm9tIGJvdGggdGhlIEdyaWdub2xpbm8gYW5kIHRoZSBCYXJiZXJhIGNsYXNzLgpPdmVyYWxsLCB0aGUgdGhyZWUgY2x1c3RlcnMgZG8gbm90IHJlY292ZXIgdGhlIHRydWUgY2xhc3MgbGFiZWxzLgoKPC9kZXRhaWxzPgoKIyMjIyBCb251czogY2FuIHlvdSBpbXByb3ZlIHRoZSByZXN1bHRzIGJ5IHVzaW5nIGRpZmZlcmVudCBkaXN0YW5jZSBtZXRyaWNzIG9yIGxpbmthZ2VzPyB7LX0KCgojIE1vZGVsLWJhc2VkIGNsdXN0ZXJpbmcKCiMjIyBUYXNrcyB7LX0KCiMjIyMgMS4gVXNlIGBtY2x1c3Q6Ok1jbHVzdCgpYCB0byBwZXJmb3JtIG1vZGVsLWJhc2VkIGNsdXN0ZXJpbmcgb24gdGhlIGB3aW5lYCBkYXRhLiB7LX0KCjxkZXRhaWxzPjxzdW1tYXJ5PlNvbHV0aW9uPC9zdW1tYXJ5PgoKYGBge3J9Cm1jIDwtIE1jbHVzdChYKQpzdW1tYXJ5KG1jKQpzdW1tYXJ5KG1jJEJJQykKYGBgCgo8L2RldGFpbHM+CgojIyMjIDIuIFZpc3VhbGl6ZSB0aGUgY2x1c3RlcmluZyB2aWEgcGFpcndpc2UgcGxvdHMuIFBsb3QgdGhlIEJJQyAoQmF5ZXNpYW4gaW5mb3JtYXRpb24gY3JpdGVyaW9uKSB2YWx1ZXMgYW5kIGludGVycHJldCB0aGUgcmVzdWx0cy4gey19CgpIaW50OiBDaGVjayBgP3Bsb3QuTWNsdXN0YC4KCjxkZXRhaWxzPjxzdW1tYXJ5PlNvbHV0aW9uPC9zdW1tYXJ5PgoKYGBge3J9CiMgUGFpcndpc2UgY2x1c3RlcmluZyBwbG90cwpwbG90KG1jLCB3aGF0ID0gImNsYXNzaWZpY2F0aW9uIikKCiMgQklDIHBsb3Q7IGV4Y2x1ZGUgdHdvIG1vZGVscyB3aXRoIHZlcnkgbG93IEJJQwpwbG90KG1jLCB3aGF0ID0gIkJJQyIsIHlsaW0gPSByYW5nZShtYyRCSUNbLCAtKDE6MildLCBuYS5ybSA9IFRSVUUpLAogIGxlZ2VuZEFyZ3MgPSBsaXN0KHggPSAiYm90dG9tbGVmdCIpCikKYGBgCgpfX0ludGVycHJldGF0aW9uX186IEEgdGhyZWUtY29tcG9uZW50IG1peHR1cmUgd2l0aCBjb3ZhcmlhbmNlcyBoYXZpbmcKZGlmZmVyZW50IHNoYXBlcyBhbmQgdm9sdW1lcyBidXQgdGhlIHNhbWUgb3JpZW50YXRpb24gKFZWRSkgcmVzdWx0cyBpbiB0aGUKaGlnaGVzdCBCSUMuIAoKPC9kZXRhaWxzPgoKIyMjIyAzLiBSZWNyZWF0ZSB0aGUgUENBIGJpcGxvdCBmcm9tIFNlY3Rpb24gMSwgYnV0IGNvbG9yIGVhY2ggb2JzZXJ2YXRpb24gYWNjb3JkaW5nIHRvIGl0cyBjbHVzdGVyLiBDb21wYXJlIHRoZSByZXN1bHRpbmcgYmlwbG90IHRvIHRoZSBlYXJsaWVyIG9uZXMuIHstfQoKPGRldGFpbHM+PHN1bW1hcnk+U29sdXRpb248L3N1bW1hcnk+CgpgYGB7cn0KIyBUYWJ1bGF0ZSBjbHVzdGVycyBhZ2FpbnN0IHRydWUgY2xhc3Nlcwp0YWJsZShjbGFzcywgbWMkY2xhc3NpZmljYXRpb24pCmBgYAoKQmlwbG90IHdpdGggYGdnYmlwbG90YDoKCmBgYHtyfQpwbG90MSA8LSBnZ2JpcGxvdCh3aW5lX3BjYSwgZ3JvdXBzID0gY2xhc3MpICsKICBzY2FsZV9jb2xvcl9tYW51YWwodmFsdWVzID0gY29scykgKwogIGxhYnMoY29sb3IgPSAiVHJ1ZSBsYWJlbHMiKSArCiAgdGhlbWUoYXNwZWN0LnJhdGlvID0gMC44LCBsZWdlbmQucG9zaXRpb24gPSAidG9wIikKCnBsb3QyIDwtIGdnYmlwbG90KHdpbmVfcGNhLCBncm91cHMgPSBmYWN0b3IobWMkY2xhc3NpZmljYXRpb24pKSArCiAgc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IGMoIiM5ZDA1ZjQiLCAiIzAxZDlkOSIsICIjZjRkYzAwIikpICsKICBsYWJzKGNvbG9yID0gIk1jbHVzdCBjbHVzdGVycyIpICsKICB0aGVtZShhc3BlY3QucmF0aW8gPSAwLjgsIGxlZ2VuZC5wb3NpdGlvbiA9ICJ0b3AiKQoKZ3JpZC5hcnJhbmdlKHBsb3QxLCBudWxsR3JvYigpLCBwbG90MiwgbmNvbCA9IDMsIHdpZHRocyA9IGMoMSwgMC4xLCAxKSkKYGBgCgpBbHRlcm5hdGl2ZWx5LCB1c2luZyBiYXNlIGBSYCBwbG90dGluZzoKCmBgYHtyfQpwYXIobWZyb3cgPSBjKDEsIDIpKQoKIyBUcnVlIGNsYXNzIGxhYmVscwpwbG90KFprLCBwY2ggPSAyMCwKICBjb2wgPSBjb2xzW2NsYXNzXSwKICB4bGFiID0gIlBDMSIsIHlsYWIgPSAiUEMyIgopCmxlZ2VuZCgidG9wbGVmdCIsIGxldmVscyhjbGFzcyksCiAgY29sID0gY29scywKICBwY2ggPSAxOQopCmFscGhhIDwtIDUgIyByZXNjYWxpbmcKZm9yIChpIGluIDE6MTMpIHsKICBhcnJvd3MoMCwgMCwgYWxwaGEgKiBWa1tpLCAxXSwgYWxwaGEgKiBWa1tpLCAyXSwgbGVuZ3RoID0gMC4yLCBjb2wgPSAiIzhmNDA0MCIpCiAgdGV4dChhbHBoYSAqIFZrW2ksIDFdLCBhbHBoYSAqIFZrW2ksIDJdLCByb3duYW1lcyhWaylbaV0sIGNvbCA9ICIjOGY0MDQwIikKfQoKY2x1c3Rlcl9jb2xzIDwtIGMoIjEiID0gIiM5ZDA1ZjQiLCAiMiIgPSAiIzAxZDlkOSIsICIzIiA9ICIjZjRkYzAwIikKIyBDbHVzdGVycwpwbG90KFprLCBwY2ggPSAyMCwKICBjb2wgPSBjbHVzdGVyX2NvbHNbZmFjdG9yKG1jJGNsYXNzaWZpY2F0aW9uKV0sCiAgeGxhYiA9ICJQQzEiLCB5bGFiID0gIlBDMiIKKQpsZWdlbmQoInRvcGxlZnQiLCBsZXZlbHMoZmFjdG9yKG1jJGNsYXNzaWZpY2F0aW9uKSksCiAgY29sID0gY2x1c3Rlcl9jb2xzLAogIHBjaCA9IDE5CikKYWxwaGEgPC0gNSAjIHJlc2NhbGluZwpmb3IgKGkgaW4gMToxMykgewogIGFycm93cygwLCAwLCBhbHBoYSAqIFZrW2ksIDFdLCBhbHBoYSAqIFZrW2ksIDJdLCBsZW5ndGggPSAwLjIsIGNvbCA9ICIjOGY0MDQwIikKICB0ZXh0KGFscGhhICogVmtbaSwgMV0sIGFscGhhICogVmtbaSwgMl0sIHJvd25hbWVzKFZrKVtpXSwgY29sID0gIiM4ZjQwNDAiKQp9CmBgYAoKX19JbnRlcnByZXRhdGlvbl9fOiBUaGUgZmlyc3QgY2x1c3RlciBjb3JyZXNwb25kcyB0byB0aGUgQmFyb2xvIGNsYXNzLCB0aGUgc2Vjb25kIGNsdXN0ZXIgdG8gdGhlIEdyaWdub2xpbm8gY2xhc3MgYW5kIHRoZSB0aGlyZCBjbHVzdGVyIHRvIEJhcmJlcmEuIApPdmVyYWxsLCB0aGUgdGhyZWUgY2x1c3RlcnMgcmVjb3ZlciB0aGUgdHJ1ZSBjbGFzcyBsYWJlbHMgdmVyeSB3ZWxsLCB3aXRoIG9ubHkgdHdvIEdyaWdub2xpbm8gd2luZXMgZmFsc2VseSBhc3NpZ25lZCB0byB0aGUgdGhpcmQgY2x1c3RlciAoQmFyYmVyYSkuCgo8L2RldGFpbHM+CgoKIyMjIyA0LiBTZWxlY3QgYW4gYXBwcm9wcmlhdGUgbnVtYmVyIG9mIFBDcyBmcm9tIHRoZSBQQ0EuIFJlcGVhdCB0aGUgbW9kZWwtYmFzZWQgY2x1c3RlcmluZyBvbiB0aGUgUENzLiBIb3cgZG8gdGhlIHJlc3VsdHMgY29tcGFyZSB0byB0aG9zZSBvbiB0aGUgZnVsbCBkYXRhPyB7LX0KCjxkZXRhaWxzPjxzdW1tYXJ5PlNvbHV0aW9uPC9zdW1tYXJ5PgpgYGB7cn0KIyBQcm9wb3J0aW9uIG9mIHZhcmlhbmNlIGV4cGxhaW5lZCBieSBlYWNoIFBDCndpbmVfcHJvcF92YXIgPC0gZGF0YS5mcmFtZSgKICBQQyA9IDE6bmNvbCh3aW5lX3BjYSR4KSwKICB2YXIgPSB3aW5lX3BjYSRzZGV2XjIgLyBzdW0od2luZV9wY2Ekc2Rldl4yKQopCgpnZ3Bsb3Qod2luZV9wcm9wX3ZhciwgYWVzKFBDLCB2YXIpKSArCiAgZ2VvbV9wb2ludCgpICsKICBnZW9tX2xpbmUoKSArCiAgZ2VvbV92bGluZSh4aW50ZXJjZXB0ID0gNy41LCBjb2wgPSAiZmlyZWJyaWNrIikgKwogIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSAxOm5jb2wod2luZV9wY2EkeCkpICsKICBsYWJzKHkgPSAiUHJvcG9ydGlvbiBvZiB2YXJpYW5jZSIpCmBgYAoKVGhlIGZpcnN0IDcgUENzIGV4cGxhaW4gYWJvdXQgOTIlIG9mIHRoZSB2YXJpYW5jZSBpbiB0aGUgYHdpbmVgIGRhdGEuCgpgYGB7cn0KIyBTZWxlY3QgdGhlIGZpcnN0IGsgUENzCmsgPC0gNwpwY2FfWCA8LSB3aW5lX3BjYSR4WywgMTprXQoKIyBSZWZpdCB0aGUgbW9kZWwtYmFzZWQgY2x1c3RlcmluZwptYzIgPC0gTWNsdXN0KHBjYV9YKQpzdW1tYXJ5KG1jMikKc3VtbWFyeShtYzIkQklDKQpgYGAKCkEgZml2ZS1jb21wb25lbnQgbWl4dHVyZSB3aXRoIGRpYWdvbmFsIGNvdmFyaWFuY2VzIGhhdmluZyBlcXVhbCBzaGFwZSwgYnV0CnZhcnlpbmcgdm9sdW1lIChWRUkpLCByZXN1bHRzIGluIHRoZSBoaWdoZXN0IEJJQy4gCgpgYGB7cn0KIyBUYWJ1bGF0ZSBjbHVzdGVycyBhZ2FpbnN0IHRydWUgY2xhc3Nlcwp0YWJsZShjbGFzcywgbWMyJGNsYXNzaWZpY2F0aW9uKQpgYGAKCkJpcGxvdCB3aXRoIGBnZ2JpcGxvdGA6CgpgYGB7cn0KcGxvdDEgPC0gZ2diaXBsb3Qod2luZV9wY2EsIGdyb3VwcyA9IGNsYXNzKSArCiAgc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IGNvbHMpICsKICBsYWJzKGNvbG9yID0gIlRydWUgbGFiZWxzIikgKwogIHRoZW1lKGFzcGVjdC5yYXRpbyA9IDAuOCwgbGVnZW5kLnBvc2l0aW9uID0gInRvcCIpCgpwbG90MiA8LSBnZ2JpcGxvdCh3aW5lX3BjYSwgZ3JvdXBzID0gZmFjdG9yKG1jMiRjbGFzc2lmaWNhdGlvbikpICsKICBzY2FsZV9jb2xvcl9tYW51YWwodmFsdWVzID0gYygiIzlkMDVmNCIsICIjMDFkOWQ5IiwgIiMwMWQ5ZDkiLCAiIzAxZDlkOSIsICIjZjRkYzAwIikpICsKICBsYWJzKGNvbG9yID0gIk1jbHVzdCBjbHVzdGVycyIpICsKICB0aGVtZShhc3BlY3QucmF0aW8gPSAwLjgsIGxlZ2VuZC5wb3NpdGlvbiA9ICJ0b3AiKQoKZ3JpZC5hcnJhbmdlKHBsb3QxLCBudWxsR3JvYigpLCBwbG90MiwgbmNvbCA9IDMsIHdpZHRocyA9IGMoMSwgMC4xLCAxKSkKYGBgCgpBbHRlcm5hdGl2ZWx5LCB1c2luZyBiYXNlIGBSYCBwbG90dGluZzoKCmBgYHtyfQpwYXIobWZyb3cgPSBjKDEsIDIpKQoKIyBUcnVlIGNsYXNzIGxhYmVscwpwbG90KFprLCBwY2ggPSAyMCwKICBjb2wgPSBjb2xzW2NsYXNzXSwKICB4bGFiID0gIlBDMSIsIHlsYWIgPSAiUEMyIgopCmxlZ2VuZCgidG9wbGVmdCIsIGxldmVscyhjbGFzcyksCiAgY29sID0gY29scywKICBwY2ggPSAxOQopCmFscGhhIDwtIDUgIyByZXNjYWxpbmcKZm9yIChpIGluIDE6MTMpIHsKICBhcnJvd3MoMCwgMCwgYWxwaGEgKiBWa1tpLCAxXSwgYWxwaGEgKiBWa1tpLCAyXSwgbGVuZ3RoID0gMC4yLCBjb2wgPSAiIzhmNDA0MCIpCiAgdGV4dChhbHBoYSAqIFZrW2ksIDFdLCBhbHBoYSAqIFZrW2ksIDJdLCByb3duYW1lcyhWaylbaV0sIGNvbCA9ICIjOGY0MDQwIikKfQoKY2x1c3Rlcl9jb2xzIDwtIGMoIjEiID0gIiM5ZDA1ZjQiLCAiMiIgPSAiIzAxZDlkOSIsICIzIiA9ICIjMDFkOWQ5IiwgIjQiID0gIiMwMWQ5ZDkiLCAiNSIgPSAiI2Y0ZGMwMCIpCiMgQ2x1c3RlcnMKcGxvdChaaywgcGNoID0gMjAsCiAgY29sID0gY2x1c3Rlcl9jb2xzW2ZhY3RvcihtYzIkY2xhc3NpZmljYXRpb24pXSwKICB4bGFiID0gIlBDMSIsIHlsYWIgPSAiUEMyIgopCmxlZ2VuZCgidG9wbGVmdCIsIGxldmVscyhmYWN0b3IobWMyJGNsYXNzaWZpY2F0aW9uKSksCiAgY29sID0gY2x1c3Rlcl9jb2xzLAogIHBjaCA9IDE5CikKYWxwaGEgPC0gNSAjIHJlc2NhbGluZwpmb3IgKGkgaW4gMToxMykgewogIGFycm93cygwLCAwLCBhbHBoYSAqIFZrW2ksIDFdLCBhbHBoYSAqIFZrW2ksIDJdLCBsZW5ndGggPSAwLjIsIGNvbCA9ICIjOGY0MDQwIikKICB0ZXh0KGFscGhhICogVmtbaSwgMV0sIGFscGhhICogVmtbaSwgMl0sIHJvd25hbWVzKFZrKVtpXSwgY29sID0gIiM4ZjQwNDAiKQp9CmBgYAoKX19JbnRlcnByZXRhdGlvbl9fOiBUaGUgZmlyc3QgY2x1c3RlciBjb3JyZXNwb25kcyB0byBtb3N0IG9mIHRoZSBCYXJvbG8gY2xhc3MuIFRoZSBmaWZ0aCBjb2xvciBtYWlubHkgY29ycmVzcG9uZHMgdG8gdGhlIEJhcmJlcmEgY2xhc3MsIHdoaWxlIGNvbnRhaW5pbmcgYSBmZXcgR3JpZ25vbGlubyB3aW5lcy4KQ29tYmluaW5nIHRoZSBzZWNvbmQsIHRoaXJkIGFuZCBmb3VydGggY2x1c3RlciByZWNvdmVycyBtb3N0IG9mIHRoZSBHcmlnbm9saW5vIGNsYXNzLCB3aXRoIHNvbWUgb3ZlcmxhcCB3aXRoIHRoZSByZW1haW5pbmcgY2xhc3Nlcy4KT3ZlcmFsbCwgYWZ0ZXIgY29tYmluaW5nIHRoZSB0aHJlZSBzbWFsbGVyIGNsdXN0ZXJzLCB0aGUgY2x1c3RlcmluZyByZWNvdmVycyB0aGUgdHJ1ZSBjbGFzcyBsYWJlbHMgZmFpcmx5IHdlbGwsIHRob3VnaCBub3QgcXVpdGUgYXMgY2xvc2VseSBhcyB0aGUgY2x1c3RlcmluZyBvbiB0aGUgb3JpZ2luYWwgZGF0YS4KCjwvZGV0YWlscz4KCiMgQWRkaXRpb25hbCByZXNvdXJjZXMgey19Ci0gU2VjdGlvbiAxNC4zIG9mIEBlc2wtYm9vawoKCmBgYHtyLCBjaGlsZD0iX3Nlc3Npb24taW5mby5SbWQifQpgYGAKClt3aW5lXTogaHR0cHM6Ly9yZHJyLmlvL2NyYW4vZ2NsdXMvbWFuL3dpbmUuaHRtbApbc2NydWNjYTIwMTZdOiBodHRwczovL3N2bi5yLXByb2plY3Qub3JnL1Jqb3VybmFsL2h0bWwvYXJjaGl2ZS8yMDE2L1JKLTIwMTYtMDIxL1JKLTIwMTYtMDIxLnBkZgoKIyBSZWZlcmVuY2VzIHstfQ==</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Lab5-Clustering.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>


</body>
</html>
